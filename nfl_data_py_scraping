{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "e0c77669",
   "metadata": {
    "heading_collapsed": true
   },
   "source": [
    "## imports, general functions, save/read-in data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f1f050d3",
   "metadata": {
    "code_folding": [
     1
    ],
    "hidden": true
   },
   "outputs": [],
   "source": [
    "# imports and installs\n",
    "try :\n",
    "    import pandas as pd\n",
    "    import numpy as np\n",
    "    import matplotlib.pyplot as plt\n",
    "    from simple_colors import * # for printing in red when debugging\n",
    "    import nfl_data_py as nfl #\n",
    "\n",
    "    # import itertools # \n",
    "    # from difflib import SequenceMatcher # string similarity\n",
    "    # import string # for \n",
    "    # from nba_api.stats.endpoints import playbyplayv2, scoreboard\n",
    "    # import requests\n",
    "    import warnings\n",
    "    import os\n",
    "    \n",
    "except Exception as e : print(red(e))    "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "23dc2f8a",
   "metadata": {
    "code_folding": [
     0,
     7,
     17
    ],
    "hidden": true
   },
   "outputs": [],
   "source": [
    "# online functions ; display_side_by_side & similar\n",
    "# turn 1 to 1st, 2 to 2nd, etc.\n",
    "ordinal = lambda n: \"%d%s\" % (n,\"tsnrhtdd\"[(n//10%10!=1)*(n%10<4)*n%10::4])\n",
    "\n",
    "# define display_side_by_side(df1,df2, titles) side-by side\n",
    "from IPython.display import display_html\n",
    "from itertools import chain,cycle\n",
    "def display_side_by_side(*args,titles=cycle([''])):\n",
    "    html_str=''\n",
    "    for df,title in zip(args, chain(titles,cycle(['</br>'])) ):\n",
    "        html_str+='<th style=\"text-align:center\"><td style=\"vertical-align:top\">'\n",
    "        html_str+=f'<h2>{title}</h2>'\n",
    "        html_str+=df.to_html().replace('table','table style=\"display:inline\"')\n",
    "        html_str+='</td></th>'\n",
    "    display_html(html_str,raw=True)\n",
    "    \n",
    "# def similar(a, b):\n",
    "def similar(a, b):\n",
    "    return SequenceMatcher(None, a, b).ratio()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "61c82f27",
   "metadata": {
    "code_folding": [
     7,
     34
    ],
    "deletable": false,
    "editable": false,
    "hidden": true,
    "run_control": {
     "frozen": true
    }
   },
   "outputs": [],
   "source": [
    "# def read_and_save_data():\n",
    "def read_and_save_data():\n",
    "    create_save_dfs()\n",
    "    \n",
    "# def create_save_dfs():\n",
    "# input : N/A, just one time run to import in data\n",
    "# output : N/A, read in data from nfl.import functions and save to appropriate folders\n",
    "def create_save_dfs():\n",
    "    warnings.filterwarnings('ignore')   \n",
    "    # prepare years to loop through\n",
    "    ystart = 2000 ; yend = 2024\n",
    "    years = np.linspace(ystart,yend, yend-ystart+1, dtype = int)\n",
    "\n",
    "    sp = r\"C:\\Users\\Rafal Adamczyk\\Documents\\portfolio projects\\(2)_NFL\"\n",
    "    # loop through recent years and save to dataframe\n",
    "    for y in years:\n",
    "        # run nfl.import functions for relevant data\n",
    "        try : \n",
    "            # create savepath to specific year\n",
    "            savepath = sp + \"\\\\\" + str(y)\n",
    "            # get relevant data\n",
    "            yearly_dfs[ f\"data_{y}\" ] = {f\"pbp_{y}\" : nfl.import_pbp_data([y]),\n",
    "                                         f\"players_{y}\" : nfl.import_rosters([y]),\n",
    "                                         f\"teams_{y}\" : nfl.import_team_desc() } \n",
    "            # save to folder to read in quicker rather than importing\n",
    "            save_to_path(yearly_dfs[ f\"data_{y}\" ], savepath)\n",
    "            print(f'Data from {y} saved.')\n",
    "        except Exception as e: print(f'Error in create_save_dfs() ; {e}')\n",
    "    warnings.filterwarnings('default')\n",
    "    \n",
    "# def save_to_paxth(dict_y, savepath):\n",
    "# input dict_y : (dict) dict of relvant dfs for appropriate year ; yearly_dfs[ f\"data_{y}\" ] in create_save_dfs()\n",
    "# input savepath : (str) path to folder to create yearly NFL folders and save data\n",
    "# output : N/A, just save dataframes to file directory\n",
    "def save_to_path(dict_y, savepath):\n",
    "    # check if path exists and is a directory (folder)\n",
    "    e = os.path.exists(savepath)\n",
    "    f = os.path.isdir(savepath)\n",
    "    # if folder already exists, save in relevant dataframes\n",
    "    if (e) & (f):\n",
    "        folder = savepath + \"\\\\\"\n",
    "        for key,val in dict_y.items() :\n",
    "            val.to_csv(folder + key + \".csv\")                \n",
    "    # if proper folders don't exist, create them and rerun function to save dfs in there\n",
    "    else :\n",
    "        os.makedirs(savepath)\n",
    "        return save_to_path(exdf, savepath)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b7e954e3",
   "metadata": {
    "deletable": false,
    "editable": false,
    "hidden": true,
    "run_control": {
     "frozen": true
    }
   },
   "outputs": [],
   "source": [
    "read_and_save_data()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "ea235039",
   "metadata": {},
   "source": [
    "## beginning analyses (2022)\n",
    "\n",
    "\n",
    "\n",
    "nfl_data_py"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3f68d27d",
   "metadata": {
    "code_folding": [],
    "deletable": false,
    "editable": false,
    "run_control": {
     "frozen": true
    }
   },
   "outputs": [],
   "source": [
    "# (ex code)\n",
    "df_2021 = nfl.import_pbp_data([2021])\n",
    "df_players = nfl.import_rosters([2021])\n",
    "df_teams = nfl.import_team_desc()\n",
    "\n",
    "# filter to regular season\n",
    "df_2021 = df_2021[df_2021[\"season_type\"] == \"REG\"]\n",
    "# remove two point attempts\n",
    "df_2021 = df_2021[df_2021[\"two_point_attempt\"] == False]\n",
    "# filter to pass plays\n",
    "df_2021 = df_2021[df_2021[\"play_type\"] == \"pass\"]\n",
    "# join with the roster table to get player names\n",
    "df_2021 = df_2021.merge(df_players[[\"player_id\", \"player_name\"]], left_on=\"passer_player_id\", right_on=\"player_id\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "15d445d5",
   "metadata": {
    "code_folding": [],
    "deletable": false,
    "editable": false
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\Rafal Adamczyk\\AppData\\Local\\Temp\\ipykernel_9196\\2022543.py:6: DtypeWarning: Columns (180,181,183,184,190,191,194,195,198,199,204,205,206,207,219,220,221,223,225,227,244,245,246,254,255,256,261,263,264,284,285,302) have mixed types. Specify dtype option on import or set low_memory=False.\n",
      "  pbp = pd.read_csv(directory + data)\n"
     ]
    }
   ],
   "source": [
    "# read in 2022 data\n",
    "directory = r'C:\\Users\\Rafal Adamczyk\\Documents\\portfolio projects\\(2)_NFL\\2022\\\\'\n",
    "for root, dirs, files in os.walk(directory):\n",
    "    for data in files:\n",
    "        if \"pbp\" in data:\n",
    "            pbp = pd.read_csv(directory + data)\n",
    "        elif \"players\" in data:\n",
    "            players = pd.read_csv(directory + data)\n",
    "        elif \"teams\" in data:\n",
    "            teams = pd.read_csv(directory + data)\n",
    "pbptemp = [col for col in pbp.columns if 'wpa' not in col]\n",
    "pbptemp = [col for col in pbp2 if 'epa' not in col]\n",
    "pbptemp = [col for col in pbp2 if 'vegas' not in col]\n",
    "pbp = pbp[pbp2]\n",
    "\n",
    "games2022 = dict(tuple(pbp.groupby('game_id')))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "6414f70a",
   "metadata": {
    "deletable": false,
    "editable": false
   },
   "outputs": [],
   "source": [
    "pd.set_option('display.max_columns', None)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "id": "e6c572c7",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Unnamed: 0</th>\n",
       "      <th>play_id</th>\n",
       "      <th>game_id</th>\n",
       "      <th>old_game_id</th>\n",
       "      <th>home_team</th>\n",
       "      <th>away_team</th>\n",
       "      <th>season_type</th>\n",
       "      <th>week</th>\n",
       "      <th>posteam</th>\n",
       "      <th>posteam_type</th>\n",
       "      <th>defteam</th>\n",
       "      <th>side_of_field</th>\n",
       "      <th>yardline_100</th>\n",
       "      <th>game_date</th>\n",
       "      <th>quarter_seconds_remaining</th>\n",
       "      <th>half_seconds_remaining</th>\n",
       "      <th>game_seconds_remaining</th>\n",
       "      <th>game_half</th>\n",
       "      <th>quarter_end</th>\n",
       "      <th>drive</th>\n",
       "      <th>sp</th>\n",
       "      <th>qtr</th>\n",
       "      <th>down</th>\n",
       "      <th>goal_to_go</th>\n",
       "      <th>time</th>\n",
       "      <th>yrdln</th>\n",
       "      <th>ydstogo</th>\n",
       "      <th>ydsnet</th>\n",
       "      <th>desc</th>\n",
       "      <th>play_type</th>\n",
       "      <th>yards_gained</th>\n",
       "      <th>shotgun</th>\n",
       "      <th>no_huddle</th>\n",
       "      <th>qb_dropback</th>\n",
       "      <th>qb_kneel</th>\n",
       "      <th>qb_spike</th>\n",
       "      <th>qb_scramble</th>\n",
       "      <th>pass_length</th>\n",
       "      <th>pass_location</th>\n",
       "      <th>air_yards</th>\n",
       "      <th>yards_after_catch</th>\n",
       "      <th>run_location</th>\n",
       "      <th>run_gap</th>\n",
       "      <th>field_goal_result</th>\n",
       "      <th>kick_distance</th>\n",
       "      <th>extra_point_result</th>\n",
       "      <th>two_point_conv_result</th>\n",
       "      <th>home_timeouts_remaining</th>\n",
       "      <th>away_timeouts_remaining</th>\n",
       "      <th>timeout</th>\n",
       "      <th>timeout_team</th>\n",
       "      <th>td_team</th>\n",
       "      <th>td_player_name</th>\n",
       "      <th>td_player_id</th>\n",
       "      <th>posteam_timeouts_remaining</th>\n",
       "      <th>defteam_timeouts_remaining</th>\n",
       "      <th>total_home_score</th>\n",
       "      <th>total_away_score</th>\n",
       "      <th>posteam_score</th>\n",
       "      <th>defteam_score</th>\n",
       "      <th>score_differential</th>\n",
       "      <th>posteam_score_post</th>\n",
       "      <th>defteam_score_post</th>\n",
       "      <th>score_differential_post</th>\n",
       "      <th>no_score_prob</th>\n",
       "      <th>opp_fg_prob</th>\n",
       "      <th>opp_safety_prob</th>\n",
       "      <th>opp_td_prob</th>\n",
       "      <th>fg_prob</th>\n",
       "      <th>safety_prob</th>\n",
       "      <th>td_prob</th>\n",
       "      <th>extra_point_prob</th>\n",
       "      <th>two_point_conversion_prob</th>\n",
       "      <th>ep</th>\n",
       "      <th>wp</th>\n",
       "      <th>def_wp</th>\n",
       "      <th>home_wp</th>\n",
       "      <th>away_wp</th>\n",
       "      <th>home_wp_post</th>\n",
       "      <th>away_wp_post</th>\n",
       "      <th>punt_blocked</th>\n",
       "      <th>first_down_rush</th>\n",
       "      <th>first_down_pass</th>\n",
       "      <th>first_down_penalty</th>\n",
       "      <th>third_down_converted</th>\n",
       "      <th>third_down_failed</th>\n",
       "      <th>fourth_down_converted</th>\n",
       "      <th>fourth_down_failed</th>\n",
       "      <th>incomplete_pass</th>\n",
       "      <th>touchback</th>\n",
       "      <th>interception</th>\n",
       "      <th>punt_inside_twenty</th>\n",
       "      <th>punt_in_endzone</th>\n",
       "      <th>punt_out_of_bounds</th>\n",
       "      <th>punt_downed</th>\n",
       "      <th>punt_fair_catch</th>\n",
       "      <th>kickoff_inside_twenty</th>\n",
       "      <th>kickoff_in_endzone</th>\n",
       "      <th>kickoff_out_of_bounds</th>\n",
       "      <th>kickoff_downed</th>\n",
       "      <th>kickoff_fair_catch</th>\n",
       "      <th>fumble_forced</th>\n",
       "      <th>fumble_not_forced</th>\n",
       "      <th>fumble_out_of_bounds</th>\n",
       "      <th>solo_tackle</th>\n",
       "      <th>safety</th>\n",
       "      <th>penalty</th>\n",
       "      <th>tackled_for_loss</th>\n",
       "      <th>fumble_lost</th>\n",
       "      <th>own_kickoff_recovery</th>\n",
       "      <th>own_kickoff_recovery_td</th>\n",
       "      <th>qb_hit</th>\n",
       "      <th>rush_attempt</th>\n",
       "      <th>pass_attempt</th>\n",
       "      <th>sack</th>\n",
       "      <th>touchdown</th>\n",
       "      <th>pass_touchdown</th>\n",
       "      <th>rush_touchdown</th>\n",
       "      <th>return_touchdown</th>\n",
       "      <th>extra_point_attempt</th>\n",
       "      <th>two_point_attempt</th>\n",
       "      <th>field_goal_attempt</th>\n",
       "      <th>kickoff_attempt</th>\n",
       "      <th>punt_attempt</th>\n",
       "      <th>fumble</th>\n",
       "      <th>complete_pass</th>\n",
       "      <th>assist_tackle</th>\n",
       "      <th>lateral_reception</th>\n",
       "      <th>lateral_rush</th>\n",
       "      <th>lateral_return</th>\n",
       "      <th>lateral_recovery</th>\n",
       "      <th>passer_player_id</th>\n",
       "      <th>passer_player_name</th>\n",
       "      <th>passing_yards</th>\n",
       "      <th>receiver_player_id</th>\n",
       "      <th>receiver_player_name</th>\n",
       "      <th>receiving_yards</th>\n",
       "      <th>rusher_player_id</th>\n",
       "      <th>rusher_player_name</th>\n",
       "      <th>rushing_yards</th>\n",
       "      <th>lateral_receiver_player_id</th>\n",
       "      <th>lateral_receiver_player_name</th>\n",
       "      <th>lateral_receiving_yards</th>\n",
       "      <th>lateral_rusher_player_id</th>\n",
       "      <th>lateral_rusher_player_name</th>\n",
       "      <th>lateral_rushing_yards</th>\n",
       "      <th>lateral_sack_player_id</th>\n",
       "      <th>lateral_sack_player_name</th>\n",
       "      <th>interception_player_id</th>\n",
       "      <th>interception_player_name</th>\n",
       "      <th>lateral_interception_player_id</th>\n",
       "      <th>lateral_interception_player_name</th>\n",
       "      <th>punt_returner_player_id</th>\n",
       "      <th>punt_returner_player_name</th>\n",
       "      <th>lateral_punt_returner_player_id</th>\n",
       "      <th>lateral_punt_returner_player_name</th>\n",
       "      <th>kickoff_returner_player_name</th>\n",
       "      <th>kickoff_returner_player_id</th>\n",
       "      <th>lateral_kickoff_returner_player_id</th>\n",
       "      <th>lateral_kickoff_returner_player_name</th>\n",
       "      <th>punter_player_id</th>\n",
       "      <th>punter_player_name</th>\n",
       "      <th>kicker_player_name</th>\n",
       "      <th>kicker_player_id</th>\n",
       "      <th>own_kickoff_recovery_player_id</th>\n",
       "      <th>own_kickoff_recovery_player_name</th>\n",
       "      <th>blocked_player_id</th>\n",
       "      <th>blocked_player_name</th>\n",
       "      <th>tackle_for_loss_1_player_id</th>\n",
       "      <th>tackle_for_loss_1_player_name</th>\n",
       "      <th>tackle_for_loss_2_player_id</th>\n",
       "      <th>tackle_for_loss_2_player_name</th>\n",
       "      <th>qb_hit_1_player_id</th>\n",
       "      <th>qb_hit_1_player_name</th>\n",
       "      <th>qb_hit_2_player_id</th>\n",
       "      <th>qb_hit_2_player_name</th>\n",
       "      <th>forced_fumble_player_1_team</th>\n",
       "      <th>forced_fumble_player_1_player_id</th>\n",
       "      <th>forced_fumble_player_1_player_name</th>\n",
       "      <th>forced_fumble_player_2_team</th>\n",
       "      <th>forced_fumble_player_2_player_id</th>\n",
       "      <th>forced_fumble_player_2_player_name</th>\n",
       "      <th>solo_tackle_1_team</th>\n",
       "      <th>solo_tackle_2_team</th>\n",
       "      <th>solo_tackle_1_player_id</th>\n",
       "      <th>solo_tackle_2_player_id</th>\n",
       "      <th>solo_tackle_1_player_name</th>\n",
       "      <th>solo_tackle_2_player_name</th>\n",
       "      <th>assist_tackle_1_player_id</th>\n",
       "      <th>assist_tackle_1_player_name</th>\n",
       "      <th>assist_tackle_1_team</th>\n",
       "      <th>assist_tackle_2_player_id</th>\n",
       "      <th>assist_tackle_2_player_name</th>\n",
       "      <th>assist_tackle_2_team</th>\n",
       "      <th>assist_tackle_3_player_id</th>\n",
       "      <th>assist_tackle_3_player_name</th>\n",
       "      <th>assist_tackle_3_team</th>\n",
       "      <th>assist_tackle_4_player_id</th>\n",
       "      <th>assist_tackle_4_player_name</th>\n",
       "      <th>assist_tackle_4_team</th>\n",
       "      <th>tackle_with_assist</th>\n",
       "      <th>tackle_with_assist_1_player_id</th>\n",
       "      <th>tackle_with_assist_1_player_name</th>\n",
       "      <th>tackle_with_assist_1_team</th>\n",
       "      <th>tackle_with_assist_2_player_id</th>\n",
       "      <th>tackle_with_assist_2_player_name</th>\n",
       "      <th>tackle_with_assist_2_team</th>\n",
       "      <th>pass_defense_1_player_id</th>\n",
       "      <th>pass_defense_1_player_name</th>\n",
       "      <th>pass_defense_2_player_id</th>\n",
       "      <th>pass_defense_2_player_name</th>\n",
       "      <th>fumbled_1_team</th>\n",
       "      <th>fumbled_1_player_id</th>\n",
       "      <th>fumbled_1_player_name</th>\n",
       "      <th>fumbled_2_player_id</th>\n",
       "      <th>fumbled_2_player_name</th>\n",
       "      <th>fumbled_2_team</th>\n",
       "      <th>fumble_recovery_1_team</th>\n",
       "      <th>fumble_recovery_1_yards</th>\n",
       "      <th>fumble_recovery_1_player_id</th>\n",
       "      <th>fumble_recovery_1_player_name</th>\n",
       "      <th>fumble_recovery_2_team</th>\n",
       "      <th>fumble_recovery_2_yards</th>\n",
       "      <th>fumble_recovery_2_player_id</th>\n",
       "      <th>fumble_recovery_2_player_name</th>\n",
       "      <th>sack_player_id</th>\n",
       "      <th>sack_player_name</th>\n",
       "      <th>half_sack_1_player_id</th>\n",
       "      <th>half_sack_1_player_name</th>\n",
       "      <th>half_sack_2_player_id</th>\n",
       "      <th>half_sack_2_player_name</th>\n",
       "      <th>return_team</th>\n",
       "      <th>return_yards</th>\n",
       "      <th>penalty_team</th>\n",
       "      <th>penalty_player_id</th>\n",
       "      <th>penalty_player_name</th>\n",
       "      <th>penalty_yards</th>\n",
       "      <th>replay_or_challenge</th>\n",
       "      <th>replay_or_challenge_result</th>\n",
       "      <th>penalty_type</th>\n",
       "      <th>defensive_two_point_attempt</th>\n",
       "      <th>defensive_two_point_conv</th>\n",
       "      <th>defensive_extra_point_attempt</th>\n",
       "      <th>defensive_extra_point_conv</th>\n",
       "      <th>safety_player_name</th>\n",
       "      <th>safety_player_id</th>\n",
       "      <th>season</th>\n",
       "      <th>cp</th>\n",
       "      <th>cpoe</th>\n",
       "      <th>series</th>\n",
       "      <th>series_success</th>\n",
       "      <th>series_result</th>\n",
       "      <th>order_sequence</th>\n",
       "      <th>start_time</th>\n",
       "      <th>time_of_day</th>\n",
       "      <th>stadium</th>\n",
       "      <th>weather</th>\n",
       "      <th>nfl_api_id</th>\n",
       "      <th>play_clock</th>\n",
       "      <th>play_deleted</th>\n",
       "      <th>play_type_nfl</th>\n",
       "      <th>special_teams_play</th>\n",
       "      <th>st_play_type</th>\n",
       "      <th>end_clock_time</th>\n",
       "      <th>end_yard_line</th>\n",
       "      <th>fixed_drive</th>\n",
       "      <th>fixed_drive_result</th>\n",
       "      <th>drive_real_start_time</th>\n",
       "      <th>drive_play_count</th>\n",
       "      <th>drive_time_of_possession</th>\n",
       "      <th>drive_first_downs</th>\n",
       "      <th>drive_inside20</th>\n",
       "      <th>drive_ended_with_score</th>\n",
       "      <th>drive_quarter_start</th>\n",
       "      <th>drive_quarter_end</th>\n",
       "      <th>drive_yards_penalized</th>\n",
       "      <th>drive_start_transition</th>\n",
       "      <th>drive_end_transition</th>\n",
       "      <th>drive_game_clock_start</th>\n",
       "      <th>drive_game_clock_end</th>\n",
       "      <th>drive_start_yard_line</th>\n",
       "      <th>drive_end_yard_line</th>\n",
       "      <th>drive_play_id_started</th>\n",
       "      <th>drive_play_id_ended</th>\n",
       "      <th>away_score</th>\n",
       "      <th>home_score</th>\n",
       "      <th>location</th>\n",
       "      <th>result</th>\n",
       "      <th>total</th>\n",
       "      <th>spread_line</th>\n",
       "      <th>total_line</th>\n",
       "      <th>div_game</th>\n",
       "      <th>roof</th>\n",
       "      <th>surface</th>\n",
       "      <th>temp</th>\n",
       "      <th>wind</th>\n",
       "      <th>home_coach</th>\n",
       "      <th>away_coach</th>\n",
       "      <th>stadium_id</th>\n",
       "      <th>game_stadium</th>\n",
       "      <th>aborted_play</th>\n",
       "      <th>success</th>\n",
       "      <th>passer</th>\n",
       "      <th>passer_jersey_number</th>\n",
       "      <th>rusher</th>\n",
       "      <th>rusher_jersey_number</th>\n",
       "      <th>receiver</th>\n",
       "      <th>receiver_jersey_number</th>\n",
       "      <th>pass</th>\n",
       "      <th>rush</th>\n",
       "      <th>first_down</th>\n",
       "      <th>special</th>\n",
       "      <th>play</th>\n",
       "      <th>passer_id</th>\n",
       "      <th>rusher_id</th>\n",
       "      <th>receiver_id</th>\n",
       "      <th>name</th>\n",
       "      <th>jersey_number</th>\n",
       "      <th>id</th>\n",
       "      <th>fantasy_player_name</th>\n",
       "      <th>fantasy_player_id</th>\n",
       "      <th>fantasy</th>\n",
       "      <th>fantasy_id</th>\n",
       "      <th>out_of_bounds</th>\n",
       "      <th>home_opening_kickoff</th>\n",
       "      <th>xyac_mean_yardage</th>\n",
       "      <th>xyac_median_yardage</th>\n",
       "      <th>xyac_success</th>\n",
       "      <th>xyac_fd</th>\n",
       "      <th>xpass</th>\n",
       "      <th>pass_oe</th>\n",
       "      <th>nflverse_game_id</th>\n",
       "      <th>possession_team</th>\n",
       "      <th>offense_formation</th>\n",
       "      <th>offense_personnel</th>\n",
       "      <th>defenders_in_box</th>\n",
       "      <th>defense_personnel</th>\n",
       "      <th>number_of_pass_rushers</th>\n",
       "      <th>players_on_play</th>\n",
       "      <th>offense_players</th>\n",
       "      <th>defense_players</th>\n",
       "      <th>n_offense</th>\n",
       "      <th>n_defense</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>3093</th>\n",
       "      <td>3093</td>\n",
       "      <td>4555.0</td>\n",
       "      <td>2022_02_ARI_LV</td>\n",
       "      <td>2022091811</td>\n",
       "      <td>LV</td>\n",
       "      <td>ARI</td>\n",
       "      <td>REG</td>\n",
       "      <td>2</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2022-09-18</td>\n",
       "      <td>231.0</td>\n",
       "      <td>231.0</td>\n",
       "      <td>231.0</td>\n",
       "      <td>Overtime</td>\n",
       "      <td>0.0</td>\n",
       "      <td>18.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>03:51</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>24.0</td>\n",
       "      <td>END GAME</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>23.0</td>\n",
       "      <td>29.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2022</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>61.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>Opp touchdown</td>\n",
       "      <td>4555.0</td>\n",
       "      <td>16:25:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Allegiant Stadium</td>\n",
       "      <td>Sunny Temp: 90° F, Humidity: 16%, Wind: SSE 12...</td>\n",
       "      <td>10160000-0588-6616-f7c6-8695a9c76b17</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>END_GAME</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>18.0</td>\n",
       "      <td>Opp touchdown</td>\n",
       "      <td>NaN</td>\n",
       "      <td>5.0</td>\n",
       "      <td>1:39</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>DOWNS</td>\n",
       "      <td>FUMBLE</td>\n",
       "      <td>05:30</td>\n",
       "      <td>03:51</td>\n",
       "      <td>LV 37</td>\n",
       "      <td>ARI 39</td>\n",
       "      <td>4397.0</td>\n",
       "      <td>4555.0</td>\n",
       "      <td>29</td>\n",
       "      <td>23</td>\n",
       "      <td>Home</td>\n",
       "      <td>-6</td>\n",
       "      <td>52</td>\n",
       "      <td>5.5</td>\n",
       "      <td>51.5</td>\n",
       "      <td>0</td>\n",
       "      <td>dome</td>\n",
       "      <td>grass</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Josh McDaniels</td>\n",
       "      <td>Kliff Kingsbury</td>\n",
       "      <td>VEG00</td>\n",
       "      <td>Allegiant Stadium</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2022_02_ARI_LV</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      Unnamed: 0  play_id         game_id  old_game_id home_team away_team  \\\n",
       "3093        3093   4555.0  2022_02_ARI_LV   2022091811        LV       ARI   \n",
       "\n",
       "     season_type  week posteam posteam_type defteam side_of_field  \\\n",
       "3093         REG     2     NaN          NaN     NaN           NaN   \n",
       "\n",
       "      yardline_100   game_date  quarter_seconds_remaining  \\\n",
       "3093           NaN  2022-09-18                      231.0   \n",
       "\n",
       "      half_seconds_remaining  game_seconds_remaining game_half  quarter_end  \\\n",
       "3093                   231.0                   231.0  Overtime          0.0   \n",
       "\n",
       "      drive   sp  qtr  down  goal_to_go   time yrdln  ydstogo  ydsnet  \\\n",
       "3093   18.0  0.0  5.0   NaN         0.0  03:51   NaN      0.0    24.0   \n",
       "\n",
       "          desc play_type  yards_gained  shotgun  no_huddle  qb_dropback  \\\n",
       "3093  END GAME       NaN           NaN      0.0        0.0          NaN   \n",
       "\n",
       "      qb_kneel  qb_spike  qb_scramble pass_length pass_location  air_yards  \\\n",
       "3093       0.0       0.0          0.0         NaN           NaN        NaN   \n",
       "\n",
       "      yards_after_catch run_location run_gap field_goal_result  kick_distance  \\\n",
       "3093                NaN          NaN     NaN               NaN            NaN   \n",
       "\n",
       "     extra_point_result two_point_conv_result  home_timeouts_remaining  \\\n",
       "3093                NaN                   NaN                      1.0   \n",
       "\n",
       "      away_timeouts_remaining  timeout timeout_team td_team td_player_name  \\\n",
       "3093                      0.0      NaN          NaN     NaN            NaN   \n",
       "\n",
       "     td_player_id  posteam_timeouts_remaining  defteam_timeouts_remaining  \\\n",
       "3093          NaN                         NaN                         NaN   \n",
       "\n",
       "      total_home_score  total_away_score  posteam_score  defteam_score  \\\n",
       "3093              23.0              29.0            NaN            NaN   \n",
       "\n",
       "      score_differential  posteam_score_post  defteam_score_post  \\\n",
       "3093                 NaN                 NaN                 NaN   \n",
       "\n",
       "      score_differential_post  no_score_prob  opp_fg_prob  opp_safety_prob  \\\n",
       "3093                      NaN            0.0          0.0              0.0   \n",
       "\n",
       "      opp_td_prob  fg_prob  safety_prob  td_prob  extra_point_prob  \\\n",
       "3093          0.0      0.0          0.0      0.0               0.0   \n",
       "\n",
       "      two_point_conversion_prob  ep  wp  def_wp  home_wp  away_wp  \\\n",
       "3093                        0.0 NaN NaN     NaN      0.0      1.0   \n",
       "\n",
       "      home_wp_post  away_wp_post  punt_blocked  first_down_rush  \\\n",
       "3093           0.0           1.0           NaN              NaN   \n",
       "\n",
       "      first_down_pass  first_down_penalty  third_down_converted  \\\n",
       "3093              NaN                 NaN                   NaN   \n",
       "\n",
       "      third_down_failed  fourth_down_converted  fourth_down_failed  \\\n",
       "3093                NaN                    NaN                 NaN   \n",
       "\n",
       "      incomplete_pass  touchback  interception  punt_inside_twenty  \\\n",
       "3093              NaN        0.0           NaN                 NaN   \n",
       "\n",
       "      punt_in_endzone  punt_out_of_bounds  punt_downed  punt_fair_catch  \\\n",
       "3093              NaN                 NaN          NaN              NaN   \n",
       "\n",
       "      kickoff_inside_twenty  kickoff_in_endzone  kickoff_out_of_bounds  \\\n",
       "3093                    NaN                 NaN                    NaN   \n",
       "\n",
       "      kickoff_downed  kickoff_fair_catch  fumble_forced  fumble_not_forced  \\\n",
       "3093             NaN                 NaN            NaN                NaN   \n",
       "\n",
       "      fumble_out_of_bounds  solo_tackle  safety  penalty  tackled_for_loss  \\\n",
       "3093                   NaN          NaN     NaN      NaN               NaN   \n",
       "\n",
       "      fumble_lost  own_kickoff_recovery  own_kickoff_recovery_td  qb_hit  \\\n",
       "3093          NaN                   NaN                      NaN     NaN   \n",
       "\n",
       "      rush_attempt  pass_attempt  sack  touchdown  pass_touchdown  \\\n",
       "3093           NaN           NaN   NaN        NaN             NaN   \n",
       "\n",
       "      rush_touchdown  return_touchdown  extra_point_attempt  \\\n",
       "3093             NaN               NaN                  NaN   \n",
       "\n",
       "      two_point_attempt  field_goal_attempt  kickoff_attempt  punt_attempt  \\\n",
       "3093                NaN                 NaN              NaN           NaN   \n",
       "\n",
       "      fumble  complete_pass  assist_tackle  lateral_reception  lateral_rush  \\\n",
       "3093     NaN            NaN            NaN                NaN           NaN   \n",
       "\n",
       "      lateral_return  lateral_recovery passer_player_id passer_player_name  \\\n",
       "3093             NaN               NaN              NaN                NaN   \n",
       "\n",
       "      passing_yards receiver_player_id receiver_player_name  receiving_yards  \\\n",
       "3093            NaN                NaN                  NaN              NaN   \n",
       "\n",
       "     rusher_player_id rusher_player_name  rushing_yards  \\\n",
       "3093              NaN                NaN            NaN   \n",
       "\n",
       "     lateral_receiver_player_id lateral_receiver_player_name  \\\n",
       "3093                        NaN                          NaN   \n",
       "\n",
       "      lateral_receiving_yards lateral_rusher_player_id  \\\n",
       "3093                      NaN                      NaN   \n",
       "\n",
       "     lateral_rusher_player_name  lateral_rushing_yards  \\\n",
       "3093                        NaN                    NaN   \n",
       "\n",
       "      lateral_sack_player_id  lateral_sack_player_name interception_player_id  \\\n",
       "3093                     NaN                       NaN                    NaN   \n",
       "\n",
       "     interception_player_name lateral_interception_player_id  \\\n",
       "3093                      NaN                            NaN   \n",
       "\n",
       "     lateral_interception_player_name punt_returner_player_id  \\\n",
       "3093                              NaN                     NaN   \n",
       "\n",
       "     punt_returner_player_name lateral_punt_returner_player_id  \\\n",
       "3093                       NaN                             NaN   \n",
       "\n",
       "     lateral_punt_returner_player_name kickoff_returner_player_name  \\\n",
       "3093                               NaN                          NaN   \n",
       "\n",
       "     kickoff_returner_player_id lateral_kickoff_returner_player_id  \\\n",
       "3093                        NaN                                NaN   \n",
       "\n",
       "     lateral_kickoff_returner_player_name punter_player_id punter_player_name  \\\n",
       "3093                                  NaN              NaN                NaN   \n",
       "\n",
       "     kicker_player_name kicker_player_id own_kickoff_recovery_player_id  \\\n",
       "3093                NaN              NaN                            NaN   \n",
       "\n",
       "     own_kickoff_recovery_player_name blocked_player_id blocked_player_name  \\\n",
       "3093                              NaN               NaN                 NaN   \n",
       "\n",
       "     tackle_for_loss_1_player_id tackle_for_loss_1_player_name  \\\n",
       "3093                         NaN                           NaN   \n",
       "\n",
       "      tackle_for_loss_2_player_id  tackle_for_loss_2_player_name  \\\n",
       "3093                          NaN                            NaN   \n",
       "\n",
       "     qb_hit_1_player_id qb_hit_1_player_name qb_hit_2_player_id  \\\n",
       "3093                NaN                  NaN                NaN   \n",
       "\n",
       "     qb_hit_2_player_name forced_fumble_player_1_team  \\\n",
       "3093                  NaN                         NaN   \n",
       "\n",
       "     forced_fumble_player_1_player_id forced_fumble_player_1_player_name  \\\n",
       "3093                              NaN                                NaN   \n",
       "\n",
       "     forced_fumble_player_2_team forced_fumble_player_2_player_id  \\\n",
       "3093                         NaN                              NaN   \n",
       "\n",
       "     forced_fumble_player_2_player_name solo_tackle_1_team solo_tackle_2_team  \\\n",
       "3093                                NaN                NaN                NaN   \n",
       "\n",
       "     solo_tackle_1_player_id solo_tackle_2_player_id  \\\n",
       "3093                     NaN                     NaN   \n",
       "\n",
       "     solo_tackle_1_player_name solo_tackle_2_player_name  \\\n",
       "3093                       NaN                       NaN   \n",
       "\n",
       "     assist_tackle_1_player_id assist_tackle_1_player_name  \\\n",
       "3093                       NaN                         NaN   \n",
       "\n",
       "     assist_tackle_1_team assist_tackle_2_player_id  \\\n",
       "3093                  NaN                       NaN   \n",
       "\n",
       "     assist_tackle_2_player_name assist_tackle_2_team  \\\n",
       "3093                         NaN                  NaN   \n",
       "\n",
       "      assist_tackle_3_player_id  assist_tackle_3_player_name  \\\n",
       "3093                        NaN                          NaN   \n",
       "\n",
       "      assist_tackle_3_team  assist_tackle_4_player_id  \\\n",
       "3093                   NaN                        NaN   \n",
       "\n",
       "      assist_tackle_4_player_name  assist_tackle_4_team  tackle_with_assist  \\\n",
       "3093                          NaN                   NaN                 NaN   \n",
       "\n",
       "     tackle_with_assist_1_player_id tackle_with_assist_1_player_name  \\\n",
       "3093                            NaN                              NaN   \n",
       "\n",
       "     tackle_with_assist_1_team tackle_with_assist_2_player_id  \\\n",
       "3093                       NaN                            NaN   \n",
       "\n",
       "     tackle_with_assist_2_player_name tackle_with_assist_2_team  \\\n",
       "3093                              NaN                       NaN   \n",
       "\n",
       "     pass_defense_1_player_id pass_defense_1_player_name  \\\n",
       "3093                      NaN                        NaN   \n",
       "\n",
       "     pass_defense_2_player_id pass_defense_2_player_name fumbled_1_team  \\\n",
       "3093                      NaN                        NaN            NaN   \n",
       "\n",
       "     fumbled_1_player_id fumbled_1_player_name fumbled_2_player_id  \\\n",
       "3093                 NaN                   NaN                 NaN   \n",
       "\n",
       "     fumbled_2_player_name fumbled_2_team fumble_recovery_1_team  \\\n",
       "3093                   NaN            NaN                    NaN   \n",
       "\n",
       "      fumble_recovery_1_yards fumble_recovery_1_player_id  \\\n",
       "3093                      NaN                         NaN   \n",
       "\n",
       "     fumble_recovery_1_player_name fumble_recovery_2_team  \\\n",
       "3093                           NaN                    NaN   \n",
       "\n",
       "      fumble_recovery_2_yards fumble_recovery_2_player_id  \\\n",
       "3093                      NaN                         NaN   \n",
       "\n",
       "     fumble_recovery_2_player_name sack_player_id sack_player_name  \\\n",
       "3093                           NaN            NaN              NaN   \n",
       "\n",
       "     half_sack_1_player_id half_sack_1_player_name half_sack_2_player_id  \\\n",
       "3093                   NaN                     NaN                   NaN   \n",
       "\n",
       "     half_sack_2_player_name return_team  return_yards penalty_team  \\\n",
       "3093                     NaN         NaN           NaN          NaN   \n",
       "\n",
       "     penalty_player_id penalty_player_name  penalty_yards  \\\n",
       "3093               NaN                 NaN            NaN   \n",
       "\n",
       "      replay_or_challenge replay_or_challenge_result penalty_type  \\\n",
       "3093                  0.0                        NaN          NaN   \n",
       "\n",
       "      defensive_two_point_attempt  defensive_two_point_conv  \\\n",
       "3093                          NaN                       NaN   \n",
       "\n",
       "      defensive_extra_point_attempt  defensive_extra_point_conv  \\\n",
       "3093                            NaN                         NaN   \n",
       "\n",
       "     safety_player_name safety_player_id  season  cp  cpoe  series  \\\n",
       "3093                NaN              NaN    2022 NaN   NaN    61.0   \n",
       "\n",
       "      series_success  series_result  order_sequence start_time time_of_day  \\\n",
       "3093             0.0  Opp touchdown          4555.0   16:25:00         NaN   \n",
       "\n",
       "                stadium                                            weather  \\\n",
       "3093  Allegiant Stadium  Sunny Temp: 90° F, Humidity: 16%, Wind: SSE 12...   \n",
       "\n",
       "                                nfl_api_id  play_clock  play_deleted  \\\n",
       "3093  10160000-0588-6616-f7c6-8695a9c76b17           0           0.0   \n",
       "\n",
       "     play_type_nfl  special_teams_play st_play_type end_clock_time  \\\n",
       "3093      END_GAME                 0.0          NaN            NaN   \n",
       "\n",
       "     end_yard_line  fixed_drive fixed_drive_result  drive_real_start_time  \\\n",
       "3093           NaN         18.0      Opp touchdown                    NaN   \n",
       "\n",
       "      drive_play_count drive_time_of_possession  drive_first_downs  \\\n",
       "3093               5.0                     1:39                1.0   \n",
       "\n",
       "      drive_inside20  drive_ended_with_score  drive_quarter_start  \\\n",
       "3093             0.0                     0.0                  5.0   \n",
       "\n",
       "      drive_quarter_end  drive_yards_penalized drive_start_transition  \\\n",
       "3093                5.0                    0.0                  DOWNS   \n",
       "\n",
       "     drive_end_transition drive_game_clock_start drive_game_clock_end  \\\n",
       "3093               FUMBLE                  05:30                03:51   \n",
       "\n",
       "     drive_start_yard_line drive_end_yard_line  drive_play_id_started  \\\n",
       "3093                 LV 37              ARI 39                 4397.0   \n",
       "\n",
       "      drive_play_id_ended  away_score  home_score location  result  total  \\\n",
       "3093               4555.0          29          23     Home      -6     52   \n",
       "\n",
       "      spread_line  total_line  div_game  roof surface  temp  wind  \\\n",
       "3093          5.5        51.5         0  dome   grass   NaN   NaN   \n",
       "\n",
       "          home_coach       away_coach stadium_id       game_stadium  \\\n",
       "3093  Josh McDaniels  Kliff Kingsbury      VEG00  Allegiant Stadium   \n",
       "\n",
       "      aborted_play  success passer  passer_jersey_number rusher  \\\n",
       "3093           0.0      NaN    NaN                   NaN    NaN   \n",
       "\n",
       "      rusher_jersey_number receiver  receiver_jersey_number  pass  rush  \\\n",
       "3093                   NaN      NaN                     NaN   0.0   0.0   \n",
       "\n",
       "      first_down  special  play passer_id rusher_id receiver_id name  \\\n",
       "3093         NaN      0.0   0.0       NaN       NaN         NaN  NaN   \n",
       "\n",
       "      jersey_number   id fantasy_player_name fantasy_player_id fantasy  \\\n",
       "3093            NaN  NaN                 NaN               NaN     NaN   \n",
       "\n",
       "     fantasy_id  out_of_bounds  home_opening_kickoff  xyac_mean_yardage  \\\n",
       "3093        NaN            0.0                   1.0                NaN   \n",
       "\n",
       "      xyac_median_yardage  xyac_success  xyac_fd  xpass  pass_oe  \\\n",
       "3093                  NaN           NaN      NaN    NaN      NaN   \n",
       "\n",
       "     nflverse_game_id possession_team offense_formation offense_personnel  \\\n",
       "3093   2022_02_ARI_LV             NaN               NaN               NaN   \n",
       "\n",
       "      defenders_in_box defense_personnel  number_of_pass_rushers  \\\n",
       "3093               NaN               NaN                     NaN   \n",
       "\n",
       "     players_on_play offense_players defense_players  n_offense  n_defense  \n",
       "3093             NaN             NaN             NaN          0          0  "
      ]
     },
     "execution_count": 29,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# example game to look through\n",
    "pd.unique( pbp.game_id )[16]\n",
    "games2022['2022_02_ARI_LV'].tail(1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "1037b98a",
   "metadata": {
    "collapsed": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Unnamed: 0\n",
      "play_id\n",
      "game_id\n",
      "old_game_id\n",
      "home_team\n",
      "away_team\n",
      "season_type\n",
      "week\n",
      "posteam\n",
      "posteam_type\n",
      "defteam\n",
      "side_of_field\n",
      "yardline_100\n",
      "game_date\n",
      "quarter_seconds_remaining\n",
      "half_seconds_remaining\n",
      "game_seconds_remaining\n",
      "game_half\n",
      "quarter_end\n",
      "drive\n",
      "sp\n",
      "qtr\n",
      "down\n",
      "goal_to_go\n",
      "time\n",
      "yrdln\n",
      "ydstogo\n",
      "ydsnet\n",
      "desc\n",
      "play_type\n",
      "yards_gained\n",
      "shotgun\n",
      "no_huddle\n",
      "qb_dropback\n",
      "qb_kneel\n",
      "qb_spike\n",
      "qb_scramble\n",
      "pass_length\n",
      "pass_location\n",
      "air_yards\n",
      "yards_after_catch\n",
      "run_location\n",
      "run_gap\n",
      "field_goal_result\n",
      "kick_distance\n",
      "extra_point_result\n",
      "two_point_conv_result\n",
      "home_timeouts_remaining\n",
      "away_timeouts_remaining\n",
      "timeout\n",
      "timeout_team\n",
      "td_team\n",
      "td_player_name\n",
      "td_player_id\n",
      "posteam_timeouts_remaining\n",
      "defteam_timeouts_remaining\n",
      "total_home_score\n",
      "total_away_score\n",
      "posteam_score\n",
      "defteam_score\n",
      "score_differential\n",
      "posteam_score_post\n",
      "defteam_score_post\n",
      "score_differential_post\n",
      "no_score_prob\n",
      "opp_fg_prob\n",
      "opp_safety_prob\n",
      "opp_td_prob\n",
      "fg_prob\n",
      "safety_prob\n",
      "td_prob\n",
      "extra_point_prob\n",
      "two_point_conversion_prob\n",
      "ep\n",
      "epa\n",
      "total_home_epa\n",
      "total_away_epa\n",
      "total_home_rush_epa\n",
      "total_away_rush_epa\n",
      "total_home_pass_epa\n",
      "total_away_pass_epa\n",
      "air_epa\n",
      "yac_epa\n",
      "comp_air_epa\n",
      "comp_yac_epa\n",
      "total_home_comp_air_epa\n",
      "total_away_comp_air_epa\n",
      "total_home_comp_yac_epa\n",
      "total_away_comp_yac_epa\n",
      "total_home_raw_air_epa\n",
      "total_away_raw_air_epa\n",
      "total_home_raw_yac_epa\n",
      "total_away_raw_yac_epa\n",
      "wp\n",
      "def_wp\n",
      "home_wp\n",
      "away_wp\n",
      "wpa\n",
      "vegas_wpa\n",
      "vegas_home_wpa\n",
      "home_wp_post\n",
      "away_wp_post\n",
      "vegas_wp\n",
      "vegas_home_wp\n",
      "total_home_rush_wpa\n",
      "total_away_rush_wpa\n",
      "total_home_pass_wpa\n",
      "total_away_pass_wpa\n",
      "air_wpa\n",
      "yac_wpa\n",
      "comp_air_wpa\n",
      "comp_yac_wpa\n",
      "total_home_comp_air_wpa\n",
      "total_away_comp_air_wpa\n",
      "total_home_comp_yac_wpa\n",
      "total_away_comp_yac_wpa\n",
      "total_home_raw_air_wpa\n",
      "total_away_raw_air_wpa\n",
      "total_home_raw_yac_wpa\n",
      "total_away_raw_yac_wpa\n",
      "punt_blocked\n",
      "first_down_rush\n",
      "first_down_pass\n",
      "first_down_penalty\n",
      "third_down_converted\n",
      "third_down_failed\n",
      "fourth_down_converted\n",
      "fourth_down_failed\n",
      "incomplete_pass\n",
      "touchback\n",
      "interception\n",
      "punt_inside_twenty\n",
      "punt_in_endzone\n",
      "punt_out_of_bounds\n",
      "punt_downed\n",
      "punt_fair_catch\n",
      "kickoff_inside_twenty\n",
      "kickoff_in_endzone\n",
      "kickoff_out_of_bounds\n",
      "kickoff_downed\n",
      "kickoff_fair_catch\n",
      "fumble_forced\n",
      "fumble_not_forced\n",
      "fumble_out_of_bounds\n",
      "solo_tackle\n",
      "safety\n",
      "penalty\n",
      "tackled_for_loss\n",
      "fumble_lost\n",
      "own_kickoff_recovery\n",
      "own_kickoff_recovery_td\n",
      "qb_hit\n",
      "rush_attempt\n",
      "pass_attempt\n",
      "sack\n",
      "touchdown\n",
      "pass_touchdown\n",
      "rush_touchdown\n",
      "return_touchdown\n",
      "extra_point_attempt\n",
      "two_point_attempt\n",
      "field_goal_attempt\n",
      "kickoff_attempt\n",
      "punt_attempt\n",
      "fumble\n",
      "complete_pass\n",
      "assist_tackle\n",
      "lateral_reception\n",
      "lateral_rush\n",
      "lateral_return\n",
      "lateral_recovery\n",
      "passer_player_id\n",
      "passer_player_name\n",
      "passing_yards\n",
      "receiver_player_id\n",
      "receiver_player_name\n",
      "receiving_yards\n",
      "rusher_player_id\n",
      "rusher_player_name\n",
      "rushing_yards\n",
      "lateral_receiver_player_id\n",
      "lateral_receiver_player_name\n",
      "lateral_receiving_yards\n",
      "lateral_rusher_player_id\n",
      "lateral_rusher_player_name\n",
      "lateral_rushing_yards\n",
      "lateral_sack_player_id\n",
      "lateral_sack_player_name\n",
      "interception_player_id\n",
      "interception_player_name\n",
      "lateral_interception_player_id\n",
      "lateral_interception_player_name\n",
      "punt_returner_player_id\n",
      "punt_returner_player_name\n",
      "lateral_punt_returner_player_id\n",
      "lateral_punt_returner_player_name\n",
      "kickoff_returner_player_name\n",
      "kickoff_returner_player_id\n",
      "lateral_kickoff_returner_player_id\n",
      "lateral_kickoff_returner_player_name\n",
      "punter_player_id\n",
      "punter_player_name\n",
      "kicker_player_name\n",
      "kicker_player_id\n",
      "own_kickoff_recovery_player_id\n",
      "own_kickoff_recovery_player_name\n",
      "blocked_player_id\n",
      "blocked_player_name\n",
      "tackle_for_loss_1_player_id\n",
      "tackle_for_loss_1_player_name\n",
      "tackle_for_loss_2_player_id\n",
      "tackle_for_loss_2_player_name\n",
      "qb_hit_1_player_id\n",
      "qb_hit_1_player_name\n",
      "qb_hit_2_player_id\n",
      "qb_hit_2_player_name\n",
      "forced_fumble_player_1_team\n",
      "forced_fumble_player_1_player_id\n",
      "forced_fumble_player_1_player_name\n",
      "forced_fumble_player_2_team\n",
      "forced_fumble_player_2_player_id\n",
      "forced_fumble_player_2_player_name\n",
      "solo_tackle_1_team\n",
      "solo_tackle_2_team\n",
      "solo_tackle_1_player_id\n",
      "solo_tackle_2_player_id\n",
      "solo_tackle_1_player_name\n",
      "solo_tackle_2_player_name\n",
      "assist_tackle_1_player_id\n",
      "assist_tackle_1_player_name\n",
      "assist_tackle_1_team\n",
      "assist_tackle_2_player_id\n",
      "assist_tackle_2_player_name\n",
      "assist_tackle_2_team\n",
      "assist_tackle_3_player_id\n",
      "assist_tackle_3_player_name\n",
      "assist_tackle_3_team\n",
      "assist_tackle_4_player_id\n",
      "assist_tackle_4_player_name\n",
      "assist_tackle_4_team\n",
      "tackle_with_assist\n",
      "tackle_with_assist_1_player_id\n",
      "tackle_with_assist_1_player_name\n",
      "tackle_with_assist_1_team\n",
      "tackle_with_assist_2_player_id\n",
      "tackle_with_assist_2_player_name\n",
      "tackle_with_assist_2_team\n",
      "pass_defense_1_player_id\n",
      "pass_defense_1_player_name\n",
      "pass_defense_2_player_id\n",
      "pass_defense_2_player_name\n",
      "fumbled_1_team\n",
      "fumbled_1_player_id\n",
      "fumbled_1_player_name\n",
      "fumbled_2_player_id\n",
      "fumbled_2_player_name\n",
      "fumbled_2_team\n",
      "fumble_recovery_1_team\n",
      "fumble_recovery_1_yards\n",
      "fumble_recovery_1_player_id\n",
      "fumble_recovery_1_player_name\n",
      "fumble_recovery_2_team\n",
      "fumble_recovery_2_yards\n",
      "fumble_recovery_2_player_id\n",
      "fumble_recovery_2_player_name\n",
      "sack_player_id\n",
      "sack_player_name\n",
      "half_sack_1_player_id\n",
      "half_sack_1_player_name\n",
      "half_sack_2_player_id\n",
      "half_sack_2_player_name\n",
      "return_team\n",
      "return_yards\n",
      "penalty_team\n",
      "penalty_player_id\n",
      "penalty_player_name\n",
      "penalty_yards\n",
      "replay_or_challenge\n",
      "replay_or_challenge_result\n",
      "penalty_type\n",
      "defensive_two_point_attempt\n",
      "defensive_two_point_conv\n",
      "defensive_extra_point_attempt\n",
      "defensive_extra_point_conv\n",
      "safety_player_name\n",
      "safety_player_id\n",
      "season\n",
      "cp\n",
      "cpoe\n",
      "series\n",
      "series_success\n",
      "series_result\n",
      "order_sequence\n",
      "start_time\n",
      "time_of_day\n",
      "stadium\n",
      "weather\n",
      "nfl_api_id\n",
      "play_clock\n",
      "play_deleted\n",
      "play_type_nfl\n",
      "special_teams_play\n",
      "st_play_type\n",
      "end_clock_time\n",
      "end_yard_line\n",
      "fixed_drive\n",
      "fixed_drive_result\n",
      "drive_real_start_time\n",
      "drive_play_count\n",
      "drive_time_of_possession\n",
      "drive_first_downs\n",
      "drive_inside20\n",
      "drive_ended_with_score\n",
      "drive_quarter_start\n",
      "drive_quarter_end\n",
      "drive_yards_penalized\n",
      "drive_start_transition\n",
      "drive_end_transition\n",
      "drive_game_clock_start\n",
      "drive_game_clock_end\n",
      "drive_start_yard_line\n",
      "drive_end_yard_line\n",
      "drive_play_id_started\n",
      "drive_play_id_ended\n",
      "away_score\n",
      "home_score\n",
      "location\n",
      "result\n",
      "total\n",
      "spread_line\n",
      "total_line\n",
      "div_game\n",
      "roof\n",
      "surface\n",
      "temp\n",
      "wind\n",
      "home_coach\n",
      "away_coach\n",
      "stadium_id\n",
      "game_stadium\n",
      "aborted_play\n",
      "success\n",
      "passer\n",
      "passer_jersey_number\n",
      "rusher\n",
      "rusher_jersey_number\n",
      "receiver\n",
      "receiver_jersey_number\n",
      "pass\n",
      "rush\n",
      "first_down\n",
      "special\n",
      "play\n",
      "passer_id\n",
      "rusher_id\n",
      "receiver_id\n",
      "name\n",
      "jersey_number\n",
      "id\n",
      "fantasy_player_name\n",
      "fantasy_player_id\n",
      "fantasy\n",
      "fantasy_id\n",
      "out_of_bounds\n",
      "home_opening_kickoff\n",
      "qb_epa\n",
      "xyac_epa\n",
      "xyac_mean_yardage\n",
      "xyac_median_yardage\n",
      "xyac_success\n",
      "xyac_fd\n",
      "xpass\n",
      "pass_oe\n",
      "nflverse_game_id\n",
      "possession_team\n",
      "offense_formation\n",
      "offense_personnel\n",
      "defenders_in_box\n",
      "defense_personnel\n",
      "number_of_pass_rushers\n",
      "players_on_play\n",
      "offense_players\n",
      "defense_players\n",
      "n_offense\n",
      "n_defense\n"
     ]
    }
   ],
   "source": [
    "for column in pbp.columns:\n",
    "    print(column)"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.12"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
