{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "e0c77669",
   "metadata": {
    "heading_collapsed": true
   },
   "source": [
    "### imports, general functions, save/read-in data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "f1f050d3",
   "metadata": {
    "code_folding": [],
    "hidden": true
   },
   "outputs": [],
   "source": [
    "# imports and installs\n",
    "try :\n",
    "    import pandas as pd\n",
    "    import numpy as np\n",
    "    import matplotlib.pyplot as plt\n",
    "    from simple_colors import * # for printing in red when debugging\n",
    "    import nfl_data_py as nfl #\n",
    "\n",
    "    # import itertools # \n",
    "    # from difflib import SequenceMatcher # string similarity\n",
    "    # import string # for \n",
    "    # from nba_api.stats.endpoints import playbyplayv2, scoreboard\n",
    "    # import requests\n",
    "    import warnings\n",
    "    import os\n",
    "    \n",
    "except Exception as e : print(red(e))    "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "23dc2f8a",
   "metadata": {
    "code_folding": [
     0,
     7,
     17
    ],
    "hidden": true
   },
   "outputs": [],
   "source": [
    "# online functions ; display_side_by_side & similar\n",
    "# turn 1 to 1st, 2 to 2nd, etc.\n",
    "ordinal = lambda n: \"%d%s\" % (n,\"tsnrhtdd\"[(n//10%10!=1)*(n%10<4)*n%10::4])\n",
    "\n",
    "# define display_side_by_side(df1,df2, titles) side-by side\n",
    "from IPython.display import display_html\n",
    "from itertools import chain,cycle\n",
    "def display_side_by_side(*args,titles=cycle([''])):\n",
    "    html_str=''\n",
    "    for df,title in zip(args, chain(titles,cycle(['</br>'])) ):\n",
    "        html_str+='<th style=\"text-align:center\"><td style=\"vertical-align:top\">'\n",
    "        html_str+=f'<h2>{title}</h2>'\n",
    "        html_str+=df.to_html().replace('table','table style=\"display:inline\"')\n",
    "        html_str+='</td></th>'\n",
    "    display_html(html_str,raw=True)\n",
    "    \n",
    "# def similar(a, b):\n",
    "def similar(a, b):\n",
    "    return SequenceMatcher(None, a, b).ratio()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "9b5f3863",
   "metadata": {
    "heading_collapsed": true
   },
   "source": [
    "### play-by-play ; disregard for now"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "61c82f27",
   "metadata": {
    "code_folding": [
     1,
     7,
     34
    ],
    "deletable": false,
    "editable": false,
    "hidden": true,
    "run_control": {
     "frozen": true
    }
   },
   "outputs": [],
   "source": [
    "# def read_and_save_data():\n",
    "def read_and_save_data():\n",
    "    create_save_dfs()\n",
    "    \n",
    "# def create_save_dfs():\n",
    "# input : N/A, just one time run to import in data\n",
    "# output : N/A, read in data from nfl.import functions and save to appropriate folders\n",
    "def create_save_dfs():\n",
    "    warnings.filterwarnings('ignore')   \n",
    "    # prepare years to loop through\n",
    "    ystart = 2000 ; yend = 2024\n",
    "    years = np.linspace(ystart,yend, yend-ystart+1, dtype = int)\n",
    "\n",
    "    sp = r\"C:\\Users\\Rafal Adamczyk\\Documents\\portfolio projects\\(2)_NFL\"\n",
    "    # loop through recent years and save to dataframe\n",
    "    for y in years:\n",
    "        # run nfl.import functions for relevant data\n",
    "        try : \n",
    "            # create savepath to specific year\n",
    "            savepath = sp + \"\\\\\" + str(y)\n",
    "            # get relevant data\n",
    "            yearly_dfs[ f\"data_{y}\" ] = {f\"pbp_{y}\" : nfl.import_pbp_data([y]),\n",
    "                                         f\"players_{y}\" : nfl.import_rosters([y]),\n",
    "                                         f\"teams_{y}\" : nfl.import_team_desc() } \n",
    "            # save to folder to read in quicker rather than importing\n",
    "            save_to_path(yearly_dfs[ f\"data_{y}\" ], savepath)\n",
    "            print(f'Data from {y} saved.')\n",
    "        except Exception as e: print(f'Error in create_save_dfs() ; {e}')\n",
    "    warnings.filterwarnings('default')\n",
    "    \n",
    "# def save_to_paxth(dict_y, savepath):\n",
    "# input dict_y : (dict) dict of relvant dfs for appropriate year ; yearly_dfs[ f\"data_{y}\" ] in create_save_dfs()\n",
    "# input savepath : (str) path to folder to create yearly NFL folders and save data\n",
    "# output : N/A, just save dataframes to file directory\n",
    "def save_to_path(dict_y, savepath):\n",
    "    # check if path exists and is a directory (folder)\n",
    "    e = os.path.exists(savepath)\n",
    "    f = os.path.isdir(savepath)\n",
    "    # if folder already exists, save in relevant dataframes\n",
    "    if (e) & (f):\n",
    "        folder = savepath + \"\\\\\"\n",
    "        for key,val in dict_y.items() :\n",
    "            val.to_csv(folder + key + \".csv\")                \n",
    "    # if proper folders don't exist, create them and rerun function to save dfs in there\n",
    "    else :\n",
    "        os.makedirs(savepath)\n",
    "        return save_to_path(exdf, savepath)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b7e954e3",
   "metadata": {
    "deletable": false,
    "editable": false,
    "hidden": true,
    "run_control": {
     "frozen": true
    }
   },
   "outputs": [],
   "source": [
    "read_and_save_data()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "dc87d9c4",
   "metadata": {
    "hidden": true
   },
   "outputs": [],
   "source": [
    "pd.set_option('display.max_columns', None)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "3568037e",
   "metadata": {},
   "source": [
    "### player performance week-to-week per season\n",
    "Goals :\n",
    "Try to predict week n performance, try models such as week n-1 performance, week n-1 and week n-2, different weights etc.\n",
    "Use current team's record as indication of \"confidence\"?"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "966cdc37",
   "metadata": {},
   "source": [
    "#### qb columns\n",
    "posteam (team on offense)\n",
    "\n",
    "desc (description of play)\n",
    "play_type\n",
    "yards_gained\n",
    "pass_length\n",
    "pass_location\n",
    "yards_after_catch\n",
    "incomplete_pass\n",
    "interception\n",
    "rush_attempt\n",
    "pass_attempt\n",
    "touchdown\n",
    "pass_touchdown\n",
    "rush_touchdown\n",
    "return_touchdown\n",
    "fumble\n",
    "complete_pass\n",
    "passer_player_id\n",
    "passer_player_name\n",
    "passing_yards\n",
    "receiver_player_id\n",
    "receiving_yards\n",
    "drive_ended_with_score\n",
    "roof\n",
    "surface\n",
    "game_stadium"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "9b7e5119",
   "metadata": {
    "code_folding": [
     0
    ],
    "deletable": false,
    "editable": false,
    "run_control": {
     "frozen": true
    }
   },
   "outputs": [],
   "source": [
    "def template():\n",
    "    function_name = sys._getframe().f_code.co_name ; start = time.time()\n",
    "    print(f'Running {red(function_name)}() ; this (scope).')\n",
    "    stop = time.time() ; duration = stop-start ; \n",
    "    print(f\"Time to (scope) : {red(np.round(duration))} seconds total.\\n\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "6414f70a",
   "metadata": {
    "deletable": false,
    "editable": false
   },
   "outputs": [],
   "source": [
    "pd.set_option('display.max_columns', None)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "a2db49a7",
   "metadata": {
    "code_folding": [
     0,
     4
    ],
    "deletable": false,
    "editable": false,
    "scrolled": false
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\Rafal Adamczyk\\AppData\\Local\\Temp\\ipykernel_13072\\1044195396.py:7: DtypeWarning: Columns (180,181,183,184,190,191,194,195,198,199,204,205,206,207,219,220,221,223,225,227,244,245,246,254,255,256,261,263,264,284,285,302) have mixed types. Specify dtype option on import or set low_memory=False.\n",
      "  pbp = pd.read_csv(directory + data)\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "'2022_02_ARI_LV'"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# read in pbp & players datasets\n",
    "# read in 2022 data\n",
    "directory = r'C:\\Users\\Rafal Adamczyk\\Documents\\portfolio projects\\(2)_NFL\\2022\\\\'\n",
    "for root, dirs, files in os.walk(directory):\n",
    "    for data in files:\n",
    "        if \"pbp\" in data:\n",
    "            pbp = pd.read_csv(directory + data)\n",
    "        elif \"players\" in data:\n",
    "            players = pd.read_csv(directory + data)\n",
    "        elif \"teams\" in data:\n",
    "            teams = pd.read_csv(directory + data)\n",
    "# remove unnecessary columns\n",
    "pbptemp = [col for col in pbp.columns if 'wpa' not in col]\n",
    "pbptemp = [col for col in pbptemp if 'epa' not in col]\n",
    "pbptemp = [col for col in pbptemp if 'vegas' not in col]\n",
    "pbptemp = [col for col in pbptemp if not col.endswith('prob')]\n",
    "pbp = pbp[pbptemp]\n",
    "\n",
    "games2022 = dict(tuple(pbp.groupby('game_id')))\n",
    "\n",
    "# pick example game to look through\n",
    "pd.unique( pbp.game_id )[16]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "46b2d17b",
   "metadata": {
    "code_folding": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>player_id</th>\n",
       "      <th>first_name</th>\n",
       "      <th>last_name</th>\n",
       "      <th>depth_chart_position</th>\n",
       "      <th>years_exp</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>962</th>\n",
       "      <td>00-0023459</td>\n",
       "      <td>Aaron</td>\n",
       "      <td>Rodgers</td>\n",
       "      <td>QB</td>\n",
       "      <td>17</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1063</th>\n",
       "      <td>00-0036991</td>\n",
       "      <td>Amari</td>\n",
       "      <td>Rodgers</td>\n",
       "      <td>WR</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1077</th>\n",
       "      <td>00-0036222</td>\n",
       "      <td>Isaiah</td>\n",
       "      <td>Rodgers</td>\n",
       "      <td>CB</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1456</th>\n",
       "      <td>00-0031384</td>\n",
       "      <td>Richard</td>\n",
       "      <td>Rodgers</td>\n",
       "      <td>TE</td>\n",
       "      <td>8</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       player_id first_name last_name depth_chart_position  years_exp\n",
       "962   00-0023459      Aaron   Rodgers                   QB         17\n",
       "1063  00-0036991      Amari   Rodgers                   WR          1\n",
       "1077  00-0036222     Isaiah   Rodgers                   CB          2\n",
       "1456  00-0031384    Richard   Rodgers                   TE          8"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# get relevant player data\n",
    "# subset for relevant columns\n",
    "playcols = ['player_id','first_name','last_name','depth_chart_position','years_exp']\n",
    "players = players[playcols]\n",
    "# manipulate for abbreviated name\n",
    "display(players[players.last_name == 'Rodgers'])\n",
    "\n",
    "pass_col = ['play_type','yards_gained','pass_length','pass_location','yards_after_catch','incomplete_pass','interception',\n",
    "            'rush_attempt','pass_attempt','touchdown','pass_touchdown','rush_touchdown','return_touchdown','fumble',\n",
    "            'complete_pass','passer_player_id','passer_player_name','passing_yards','receiver_player_id','weather','sack',\n",
    "            'receiving_yards','drive_ended_with_score','roof','surface','game_stadium','ydstogo','passer','passer_id',\n",
    "            'defenders_in_box','fourth_down_failed','first_down','penalty','penalty_type','spread_line','total_line',\n",
    "           'posteam', 'week', 'home_opening_kickoff']\n",
    "# etc."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "id": "e61d8983",
   "metadata": {
    "code_folding": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "1\n",
      "39\n",
      "2\n",
      "34\n"
     ]
    }
   ],
   "source": [
    "# def filter_by_player(df,pid):\n",
    "# input df : (pd.df) df pf yearly pbp data to filter through\n",
    "# input pid : (str) player_id\n",
    "def filter_by_player(df, pid, pass_col):\n",
    "    # get rows where inputted df has the player's id 'pid' in a column/row element\n",
    "    pid_plays = df[df.apply(lambda x: any(value == pid for value in x.values), axis=1)]\n",
    "    # get list of weeks where player played\n",
    "#     for row in pid_plays.head(2).iloc:\n",
    "#         print(red(row.week), row.passer_player_id)\n",
    "\n",
    "#     rel_weeks = np.linspace(1,np.max(pid_plays.week),np.max(pid_plays.week), dtype=int)\n",
    "    rel_weeks = [1,2] # set to first 2 weeks for convenience\n",
    "    for w in rel_weeks:\n",
    "        # get all plays involving player on week w\n",
    "        pid_week = pid_plays[pid_plays.week == w]\n",
    "        \n",
    "    # same length as just_pid ?\n",
    "#     pid_anywhere  = df[df.apply(lambda x: pid in x.values, axis=1)]\n",
    "\n",
    "# practice with Aaron Rodgers    \n",
    "filter_by_player(pbp,'00-0023459',pass_col)\n",
    "# secondary ex with Isaiah Rodgers\n",
    "# filter_by_player(pbp,'00-0036222',pass_col)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "61bca5ba",
   "metadata": {
    "code_folding": [],
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Unnamed: 0   ;   play_id   ;   game_id   ;   old_game_id   ;   home_team   ;   away_team   ;   season_type   ;   week   ;   posteam   ;   posteam_type   ;   defteam   ;   side_of_field   ;   yardline_100   ;   game_date   ;   quarter_seconds_remaining   ;   half_seconds_remaining   ;   game_seconds_remaining   ;   game_half   ;   quarter_end   ;   drive   ;   sp   ;   qtr   ;   down   ;   goal_to_go   ;   time   ;   yrdln   ;   ydstogo   ;   ydsnet   ;   desc   ;   play_type   ;   yards_gained   ;   shotgun   ;   no_huddle   ;   qb_dropback   ;   qb_kneel   ;   qb_spike   ;   qb_scramble   ;   pass_length   ;   pass_location   ;   air_yards   ;   yards_after_catch   ;   run_location   ;   run_gap   ;   field_goal_result   ;   kick_distance   ;   extra_point_result   ;   two_point_conv_result   ;   home_timeouts_remaining   ;   away_timeouts_remaining   ;   timeout   ;   timeout_team   ;   td_team   ;   td_player_name   ;   td_player_id   ;   posteam_timeouts_remaining   ;   defteam_timeouts_remaining   ;   total_home_score   ;   total_away_score   ;   posteam_score   ;   defteam_score   ;   score_differential   ;   posteam_score_post   ;   defteam_score_post   ;   score_differential_post   ;   ep   ;   wp   ;   def_wp   ;   home_wp   ;   away_wp   ;   home_wp_post   ;   away_wp_post   ;   punt_blocked   ;   first_down_rush   ;   first_down_pass   ;   first_down_penalty   ;   third_down_converted   ;   third_down_failed   ;   fourth_down_converted   ;   fourth_down_failed   ;   incomplete_pass   ;   touchback   ;   interception   ;   punt_inside_twenty   ;   punt_in_endzone   ;   punt_out_of_bounds   ;   punt_downed   ;   punt_fair_catch   ;   kickoff_inside_twenty   ;   kickoff_in_endzone   ;   kickoff_out_of_bounds   ;   kickoff_downed   ;   kickoff_fair_catch   ;   fumble_forced   ;   fumble_not_forced   ;   fumble_out_of_bounds   ;   solo_tackle   ;   safety   ;   penalty   ;   tackled_for_loss   ;   fumble_lost   ;   own_kickoff_recovery   ;   own_kickoff_recovery_td   ;   qb_hit   ;   rush_attempt   ;   pass_attempt   ;   sack   ;   touchdown   ;   pass_touchdown   ;   rush_touchdown   ;   return_touchdown   ;   extra_point_attempt   ;   two_point_attempt   ;   field_goal_attempt   ;   kickoff_attempt   ;   punt_attempt   ;   fumble   ;   complete_pass   ;   assist_tackle   ;   lateral_reception   ;   lateral_rush   ;   lateral_return   ;   lateral_recovery   ;   passer_player_id   ;   passer_player_name   ;   passing_yards   ;   receiver_player_id   ;   receiver_player_name   ;   receiving_yards   ;   rusher_player_id   ;   rusher_player_name   ;   rushing_yards   ;   lateral_receiver_player_id   ;   lateral_receiver_player_name   ;   lateral_receiving_yards   ;   lateral_rusher_player_id   ;   lateral_rusher_player_name   ;   lateral_rushing_yards   ;   lateral_sack_player_id   ;   lateral_sack_player_name   ;   interception_player_id   ;   interception_player_name   ;   lateral_interception_player_id   ;   lateral_interception_player_name   ;   punt_returner_player_id   ;   punt_returner_player_name   ;   lateral_punt_returner_player_id   ;   lateral_punt_returner_player_name   ;   kickoff_returner_player_name   ;   kickoff_returner_player_id   ;   lateral_kickoff_returner_player_id   ;   lateral_kickoff_returner_player_name   ;   punter_player_id   ;   punter_player_name   ;   kicker_player_name   ;   kicker_player_id   ;   own_kickoff_recovery_player_id   ;   own_kickoff_recovery_player_name   ;   blocked_player_id   ;   blocked_player_name   ;   tackle_for_loss_1_player_id   ;   tackle_for_loss_1_player_name   ;   tackle_for_loss_2_player_id   ;   tackle_for_loss_2_player_name   ;   qb_hit_1_player_id   ;   qb_hit_1_player_name   ;   qb_hit_2_player_id   ;   qb_hit_2_player_name   ;   forced_fumble_player_1_team   ;   forced_fumble_player_1_player_id   ;   forced_fumble_player_1_player_name   ;   forced_fumble_player_2_team   ;   forced_fumble_player_2_player_id   ;   forced_fumble_player_2_player_name   ;   solo_tackle_1_team   ;   solo_tackle_2_team   ;   solo_tackle_1_player_id   ;   solo_tackle_2_player_id   ;   solo_tackle_1_player_name   ;   solo_tackle_2_player_name   ;   assist_tackle_1_player_id   ;   assist_tackle_1_player_name   ;   assist_tackle_1_team   ;   assist_tackle_2_player_id   ;   assist_tackle_2_player_name   ;   assist_tackle_2_team   ;   assist_tackle_3_player_id   ;   assist_tackle_3_player_name   ;   assist_tackle_3_team   ;   assist_tackle_4_player_id   ;   assist_tackle_4_player_name   ;   assist_tackle_4_team   ;   tackle_with_assist   ;   tackle_with_assist_1_player_id   ;   tackle_with_assist_1_player_name   ;   tackle_with_assist_1_team   ;   tackle_with_assist_2_player_id   ;   tackle_with_assist_2_player_name   ;   tackle_with_assist_2_team   ;   pass_defense_1_player_id   ;   pass_defense_1_player_name   ;   pass_defense_2_player_id   ;   pass_defense_2_player_name   ;   fumbled_1_team   ;   fumbled_1_player_id   ;   fumbled_1_player_name   ;   fumbled_2_player_id   ;   fumbled_2_player_name   ;   fumbled_2_team   ;   fumble_recovery_1_team   ;   fumble_recovery_1_yards   ;   fumble_recovery_1_player_id   ;   fumble_recovery_1_player_name   ;   fumble_recovery_2_team   ;   fumble_recovery_2_yards   ;   fumble_recovery_2_player_id   ;   fumble_recovery_2_player_name   ;   sack_player_id   ;   sack_player_name   ;   half_sack_1_player_id   ;   half_sack_1_player_name   ;   half_sack_2_player_id   ;   half_sack_2_player_name   ;   return_team   ;   return_yards   ;   penalty_team   ;   penalty_player_id   ;   penalty_player_name   ;   penalty_yards   ;   replay_or_challenge   ;   replay_or_challenge_result   ;   penalty_type   ;   defensive_two_point_attempt   ;   defensive_two_point_conv   ;   defensive_extra_point_attempt   ;   defensive_extra_point_conv   ;   safety_player_name   ;   safety_player_id   ;   season   ;   cp   ;   cpoe   ;   series   ;   series_success   ;   series_result   ;   order_sequence   ;   start_time   ;   time_of_day   ;   stadium   ;   weather   ;   nfl_api_id   ;   play_clock   ;   play_deleted   ;   play_type_nfl   ;   special_teams_play   ;   st_play_type   ;   end_clock_time   ;   end_yard_line   ;   fixed_drive   ;   fixed_drive_result   ;   drive_real_start_time   ;   drive_play_count   ;   drive_time_of_possession   ;   drive_first_downs   ;   drive_inside20   ;   drive_ended_with_score   ;   drive_quarter_start   ;   drive_quarter_end   ;   drive_yards_penalized   ;   drive_start_transition   ;   drive_end_transition   ;   drive_game_clock_start   ;   drive_game_clock_end   ;   drive_start_yard_line   ;   drive_end_yard_line   ;   drive_play_id_started   ;   drive_play_id_ended   ;   away_score   ;   home_score   ;   location   ;   result   ;   total   ;   spread_line   ;   total_line   ;   div_game   ;   roof   ;   surface   ;   temp   ;   wind   ;   home_coach   ;   away_coach   ;   stadium_id   ;   game_stadium   ;   aborted_play   ;   success   ;   passer   ;   passer_jersey_number   ;   rusher   ;   rusher_jersey_number   ;   receiver   ;   receiver_jersey_number   ;   pass   ;   rush   ;   first_down   ;   special   ;   play   ;   passer_id   ;   rusher_id   ;   receiver_id   ;   name   ;   jersey_number   ;   id   ;   fantasy_player_name   ;   fantasy_player_id   ;   fantasy   ;   fantasy_id   ;   out_of_bounds   ;   home_opening_kickoff   ;   xyac_mean_yardage   ;   xyac_median_yardage   ;   xyac_success   ;   xyac_fd   ;   xpass   ;   pass_oe   ;   nflverse_game_id   ;   possession_team   ;   offense_formation   ;   offense_personnel   ;   defenders_in_box   ;   defense_personnel   ;   number_of_pass_rushers   ;   players_on_play   ;   offense_players   ;   defense_players   ;   n_offense   ;   n_defense   ;   "
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Unnamed: 0</th>\n",
       "      <th>play_id</th>\n",
       "      <th>game_id</th>\n",
       "      <th>old_game_id</th>\n",
       "      <th>home_team</th>\n",
       "      <th>away_team</th>\n",
       "      <th>season_type</th>\n",
       "      <th>week</th>\n",
       "      <th>posteam</th>\n",
       "      <th>posteam_type</th>\n",
       "      <th>defteam</th>\n",
       "      <th>side_of_field</th>\n",
       "      <th>yardline_100</th>\n",
       "      <th>game_date</th>\n",
       "      <th>quarter_seconds_remaining</th>\n",
       "      <th>half_seconds_remaining</th>\n",
       "      <th>game_seconds_remaining</th>\n",
       "      <th>game_half</th>\n",
       "      <th>quarter_end</th>\n",
       "      <th>drive</th>\n",
       "      <th>sp</th>\n",
       "      <th>qtr</th>\n",
       "      <th>down</th>\n",
       "      <th>goal_to_go</th>\n",
       "      <th>time</th>\n",
       "      <th>yrdln</th>\n",
       "      <th>ydstogo</th>\n",
       "      <th>ydsnet</th>\n",
       "      <th>desc</th>\n",
       "      <th>play_type</th>\n",
       "      <th>yards_gained</th>\n",
       "      <th>shotgun</th>\n",
       "      <th>no_huddle</th>\n",
       "      <th>qb_dropback</th>\n",
       "      <th>qb_kneel</th>\n",
       "      <th>qb_spike</th>\n",
       "      <th>qb_scramble</th>\n",
       "      <th>pass_length</th>\n",
       "      <th>pass_location</th>\n",
       "      <th>air_yards</th>\n",
       "      <th>yards_after_catch</th>\n",
       "      <th>run_location</th>\n",
       "      <th>run_gap</th>\n",
       "      <th>field_goal_result</th>\n",
       "      <th>kick_distance</th>\n",
       "      <th>extra_point_result</th>\n",
       "      <th>two_point_conv_result</th>\n",
       "      <th>home_timeouts_remaining</th>\n",
       "      <th>away_timeouts_remaining</th>\n",
       "      <th>timeout</th>\n",
       "      <th>timeout_team</th>\n",
       "      <th>td_team</th>\n",
       "      <th>td_player_name</th>\n",
       "      <th>td_player_id</th>\n",
       "      <th>posteam_timeouts_remaining</th>\n",
       "      <th>defteam_timeouts_remaining</th>\n",
       "      <th>total_home_score</th>\n",
       "      <th>total_away_score</th>\n",
       "      <th>posteam_score</th>\n",
       "      <th>defteam_score</th>\n",
       "      <th>score_differential</th>\n",
       "      <th>posteam_score_post</th>\n",
       "      <th>defteam_score_post</th>\n",
       "      <th>score_differential_post</th>\n",
       "      <th>ep</th>\n",
       "      <th>wp</th>\n",
       "      <th>def_wp</th>\n",
       "      <th>home_wp</th>\n",
       "      <th>away_wp</th>\n",
       "      <th>home_wp_post</th>\n",
       "      <th>away_wp_post</th>\n",
       "      <th>punt_blocked</th>\n",
       "      <th>first_down_rush</th>\n",
       "      <th>first_down_pass</th>\n",
       "      <th>first_down_penalty</th>\n",
       "      <th>third_down_converted</th>\n",
       "      <th>third_down_failed</th>\n",
       "      <th>fourth_down_converted</th>\n",
       "      <th>fourth_down_failed</th>\n",
       "      <th>incomplete_pass</th>\n",
       "      <th>touchback</th>\n",
       "      <th>interception</th>\n",
       "      <th>punt_inside_twenty</th>\n",
       "      <th>punt_in_endzone</th>\n",
       "      <th>punt_out_of_bounds</th>\n",
       "      <th>punt_downed</th>\n",
       "      <th>punt_fair_catch</th>\n",
       "      <th>kickoff_inside_twenty</th>\n",
       "      <th>kickoff_in_endzone</th>\n",
       "      <th>kickoff_out_of_bounds</th>\n",
       "      <th>kickoff_downed</th>\n",
       "      <th>kickoff_fair_catch</th>\n",
       "      <th>fumble_forced</th>\n",
       "      <th>fumble_not_forced</th>\n",
       "      <th>fumble_out_of_bounds</th>\n",
       "      <th>solo_tackle</th>\n",
       "      <th>safety</th>\n",
       "      <th>penalty</th>\n",
       "      <th>tackled_for_loss</th>\n",
       "      <th>fumble_lost</th>\n",
       "      <th>own_kickoff_recovery</th>\n",
       "      <th>own_kickoff_recovery_td</th>\n",
       "      <th>qb_hit</th>\n",
       "      <th>rush_attempt</th>\n",
       "      <th>pass_attempt</th>\n",
       "      <th>sack</th>\n",
       "      <th>touchdown</th>\n",
       "      <th>pass_touchdown</th>\n",
       "      <th>rush_touchdown</th>\n",
       "      <th>return_touchdown</th>\n",
       "      <th>extra_point_attempt</th>\n",
       "      <th>two_point_attempt</th>\n",
       "      <th>field_goal_attempt</th>\n",
       "      <th>kickoff_attempt</th>\n",
       "      <th>punt_attempt</th>\n",
       "      <th>fumble</th>\n",
       "      <th>complete_pass</th>\n",
       "      <th>assist_tackle</th>\n",
       "      <th>lateral_reception</th>\n",
       "      <th>lateral_rush</th>\n",
       "      <th>lateral_return</th>\n",
       "      <th>lateral_recovery</th>\n",
       "      <th>passer_player_id</th>\n",
       "      <th>passer_player_name</th>\n",
       "      <th>passing_yards</th>\n",
       "      <th>receiver_player_id</th>\n",
       "      <th>receiver_player_name</th>\n",
       "      <th>receiving_yards</th>\n",
       "      <th>rusher_player_id</th>\n",
       "      <th>rusher_player_name</th>\n",
       "      <th>rushing_yards</th>\n",
       "      <th>lateral_receiver_player_id</th>\n",
       "      <th>lateral_receiver_player_name</th>\n",
       "      <th>lateral_receiving_yards</th>\n",
       "      <th>lateral_rusher_player_id</th>\n",
       "      <th>lateral_rusher_player_name</th>\n",
       "      <th>lateral_rushing_yards</th>\n",
       "      <th>lateral_sack_player_id</th>\n",
       "      <th>lateral_sack_player_name</th>\n",
       "      <th>interception_player_id</th>\n",
       "      <th>interception_player_name</th>\n",
       "      <th>lateral_interception_player_id</th>\n",
       "      <th>lateral_interception_player_name</th>\n",
       "      <th>punt_returner_player_id</th>\n",
       "      <th>punt_returner_player_name</th>\n",
       "      <th>lateral_punt_returner_player_id</th>\n",
       "      <th>lateral_punt_returner_player_name</th>\n",
       "      <th>kickoff_returner_player_name</th>\n",
       "      <th>kickoff_returner_player_id</th>\n",
       "      <th>lateral_kickoff_returner_player_id</th>\n",
       "      <th>lateral_kickoff_returner_player_name</th>\n",
       "      <th>punter_player_id</th>\n",
       "      <th>punter_player_name</th>\n",
       "      <th>kicker_player_name</th>\n",
       "      <th>kicker_player_id</th>\n",
       "      <th>own_kickoff_recovery_player_id</th>\n",
       "      <th>own_kickoff_recovery_player_name</th>\n",
       "      <th>blocked_player_id</th>\n",
       "      <th>blocked_player_name</th>\n",
       "      <th>tackle_for_loss_1_player_id</th>\n",
       "      <th>tackle_for_loss_1_player_name</th>\n",
       "      <th>tackle_for_loss_2_player_id</th>\n",
       "      <th>tackle_for_loss_2_player_name</th>\n",
       "      <th>qb_hit_1_player_id</th>\n",
       "      <th>qb_hit_1_player_name</th>\n",
       "      <th>qb_hit_2_player_id</th>\n",
       "      <th>qb_hit_2_player_name</th>\n",
       "      <th>forced_fumble_player_1_team</th>\n",
       "      <th>forced_fumble_player_1_player_id</th>\n",
       "      <th>forced_fumble_player_1_player_name</th>\n",
       "      <th>forced_fumble_player_2_team</th>\n",
       "      <th>forced_fumble_player_2_player_id</th>\n",
       "      <th>forced_fumble_player_2_player_name</th>\n",
       "      <th>solo_tackle_1_team</th>\n",
       "      <th>solo_tackle_2_team</th>\n",
       "      <th>solo_tackle_1_player_id</th>\n",
       "      <th>solo_tackle_2_player_id</th>\n",
       "      <th>solo_tackle_1_player_name</th>\n",
       "      <th>solo_tackle_2_player_name</th>\n",
       "      <th>assist_tackle_1_player_id</th>\n",
       "      <th>assist_tackle_1_player_name</th>\n",
       "      <th>assist_tackle_1_team</th>\n",
       "      <th>assist_tackle_2_player_id</th>\n",
       "      <th>assist_tackle_2_player_name</th>\n",
       "      <th>assist_tackle_2_team</th>\n",
       "      <th>assist_tackle_3_player_id</th>\n",
       "      <th>assist_tackle_3_player_name</th>\n",
       "      <th>assist_tackle_3_team</th>\n",
       "      <th>assist_tackle_4_player_id</th>\n",
       "      <th>assist_tackle_4_player_name</th>\n",
       "      <th>assist_tackle_4_team</th>\n",
       "      <th>tackle_with_assist</th>\n",
       "      <th>tackle_with_assist_1_player_id</th>\n",
       "      <th>tackle_with_assist_1_player_name</th>\n",
       "      <th>tackle_with_assist_1_team</th>\n",
       "      <th>tackle_with_assist_2_player_id</th>\n",
       "      <th>tackle_with_assist_2_player_name</th>\n",
       "      <th>tackle_with_assist_2_team</th>\n",
       "      <th>pass_defense_1_player_id</th>\n",
       "      <th>pass_defense_1_player_name</th>\n",
       "      <th>pass_defense_2_player_id</th>\n",
       "      <th>pass_defense_2_player_name</th>\n",
       "      <th>fumbled_1_team</th>\n",
       "      <th>fumbled_1_player_id</th>\n",
       "      <th>fumbled_1_player_name</th>\n",
       "      <th>fumbled_2_player_id</th>\n",
       "      <th>fumbled_2_player_name</th>\n",
       "      <th>fumbled_2_team</th>\n",
       "      <th>fumble_recovery_1_team</th>\n",
       "      <th>fumble_recovery_1_yards</th>\n",
       "      <th>fumble_recovery_1_player_id</th>\n",
       "      <th>fumble_recovery_1_player_name</th>\n",
       "      <th>fumble_recovery_2_team</th>\n",
       "      <th>fumble_recovery_2_yards</th>\n",
       "      <th>fumble_recovery_2_player_id</th>\n",
       "      <th>fumble_recovery_2_player_name</th>\n",
       "      <th>sack_player_id</th>\n",
       "      <th>sack_player_name</th>\n",
       "      <th>half_sack_1_player_id</th>\n",
       "      <th>half_sack_1_player_name</th>\n",
       "      <th>half_sack_2_player_id</th>\n",
       "      <th>half_sack_2_player_name</th>\n",
       "      <th>return_team</th>\n",
       "      <th>return_yards</th>\n",
       "      <th>penalty_team</th>\n",
       "      <th>penalty_player_id</th>\n",
       "      <th>penalty_player_name</th>\n",
       "      <th>penalty_yards</th>\n",
       "      <th>replay_or_challenge</th>\n",
       "      <th>replay_or_challenge_result</th>\n",
       "      <th>penalty_type</th>\n",
       "      <th>defensive_two_point_attempt</th>\n",
       "      <th>defensive_two_point_conv</th>\n",
       "      <th>defensive_extra_point_attempt</th>\n",
       "      <th>defensive_extra_point_conv</th>\n",
       "      <th>safety_player_name</th>\n",
       "      <th>safety_player_id</th>\n",
       "      <th>season</th>\n",
       "      <th>cp</th>\n",
       "      <th>cpoe</th>\n",
       "      <th>series</th>\n",
       "      <th>series_success</th>\n",
       "      <th>series_result</th>\n",
       "      <th>order_sequence</th>\n",
       "      <th>start_time</th>\n",
       "      <th>time_of_day</th>\n",
       "      <th>stadium</th>\n",
       "      <th>weather</th>\n",
       "      <th>nfl_api_id</th>\n",
       "      <th>play_clock</th>\n",
       "      <th>play_deleted</th>\n",
       "      <th>play_type_nfl</th>\n",
       "      <th>special_teams_play</th>\n",
       "      <th>st_play_type</th>\n",
       "      <th>end_clock_time</th>\n",
       "      <th>end_yard_line</th>\n",
       "      <th>fixed_drive</th>\n",
       "      <th>fixed_drive_result</th>\n",
       "      <th>drive_real_start_time</th>\n",
       "      <th>drive_play_count</th>\n",
       "      <th>drive_time_of_possession</th>\n",
       "      <th>drive_first_downs</th>\n",
       "      <th>drive_inside20</th>\n",
       "      <th>drive_ended_with_score</th>\n",
       "      <th>drive_quarter_start</th>\n",
       "      <th>drive_quarter_end</th>\n",
       "      <th>drive_yards_penalized</th>\n",
       "      <th>drive_start_transition</th>\n",
       "      <th>drive_end_transition</th>\n",
       "      <th>drive_game_clock_start</th>\n",
       "      <th>drive_game_clock_end</th>\n",
       "      <th>drive_start_yard_line</th>\n",
       "      <th>drive_end_yard_line</th>\n",
       "      <th>drive_play_id_started</th>\n",
       "      <th>drive_play_id_ended</th>\n",
       "      <th>away_score</th>\n",
       "      <th>home_score</th>\n",
       "      <th>location</th>\n",
       "      <th>result</th>\n",
       "      <th>total</th>\n",
       "      <th>spread_line</th>\n",
       "      <th>total_line</th>\n",
       "      <th>div_game</th>\n",
       "      <th>roof</th>\n",
       "      <th>surface</th>\n",
       "      <th>temp</th>\n",
       "      <th>wind</th>\n",
       "      <th>home_coach</th>\n",
       "      <th>away_coach</th>\n",
       "      <th>stadium_id</th>\n",
       "      <th>game_stadium</th>\n",
       "      <th>aborted_play</th>\n",
       "      <th>success</th>\n",
       "      <th>passer</th>\n",
       "      <th>passer_jersey_number</th>\n",
       "      <th>rusher</th>\n",
       "      <th>rusher_jersey_number</th>\n",
       "      <th>receiver</th>\n",
       "      <th>receiver_jersey_number</th>\n",
       "      <th>pass</th>\n",
       "      <th>rush</th>\n",
       "      <th>first_down</th>\n",
       "      <th>special</th>\n",
       "      <th>play</th>\n",
       "      <th>passer_id</th>\n",
       "      <th>rusher_id</th>\n",
       "      <th>receiver_id</th>\n",
       "      <th>name</th>\n",
       "      <th>jersey_number</th>\n",
       "      <th>id</th>\n",
       "      <th>fantasy_player_name</th>\n",
       "      <th>fantasy_player_id</th>\n",
       "      <th>fantasy</th>\n",
       "      <th>fantasy_id</th>\n",
       "      <th>out_of_bounds</th>\n",
       "      <th>home_opening_kickoff</th>\n",
       "      <th>xyac_mean_yardage</th>\n",
       "      <th>xyac_median_yardage</th>\n",
       "      <th>xyac_success</th>\n",
       "      <th>xyac_fd</th>\n",
       "      <th>xpass</th>\n",
       "      <th>pass_oe</th>\n",
       "      <th>nflverse_game_id</th>\n",
       "      <th>possession_team</th>\n",
       "      <th>offense_formation</th>\n",
       "      <th>offense_personnel</th>\n",
       "      <th>defenders_in_box</th>\n",
       "      <th>defense_personnel</th>\n",
       "      <th>number_of_pass_rushers</th>\n",
       "      <th>players_on_play</th>\n",
       "      <th>offense_players</th>\n",
       "      <th>defense_players</th>\n",
       "      <th>n_offense</th>\n",
       "      <th>n_defense</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>50146</th>\n",
       "      <td>50146</td>\n",
       "      <td>4094.0</td>\n",
       "      <td>2022_22_KC_PHI</td>\n",
       "      <td>2023021200</td>\n",
       "      <td>PHI</td>\n",
       "      <td>KC</td>\n",
       "      <td>POST</td>\n",
       "      <td>22</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2023-02-12</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>Half2</td>\n",
       "      <td>0.0</td>\n",
       "      <td>18.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>END GAME</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>35.0</td>\n",
       "      <td>38.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2022</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>56.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>End of half</td>\n",
       "      <td>4094.0</td>\n",
       "      <td>18:30:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>10160000-0591-71e8-06f2-f6c338c350ce</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>END_GAME</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>18.0</td>\n",
       "      <td>End of half</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0:08</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>KICKOFF</td>\n",
       "      <td>END_GAME</td>\n",
       "      <td>00:08</td>\n",
       "      <td>00:00</td>\n",
       "      <td>PHI 36</td>\n",
       "      <td>PHI 36</td>\n",
       "      <td>4050.0</td>\n",
       "      <td>4094.0</td>\n",
       "      <td>38</td>\n",
       "      <td>35</td>\n",
       "      <td>Neutral</td>\n",
       "      <td>-3</td>\n",
       "      <td>73</td>\n",
       "      <td>1.0</td>\n",
       "      <td>51.0</td>\n",
       "      <td>0</td>\n",
       "      <td>closed</td>\n",
       "      <td>grass</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Nick Sirianni</td>\n",
       "      <td>Andy Reid</td>\n",
       "      <td>PHO00</td>\n",
       "      <td>State Farm Stadium</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2022_23_KC_PHI</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      Unnamed: 0 play_id         game_id old_game_id home_team away_team  \\\n",
       "50146      50146  4094.0  2022_22_KC_PHI  2023021200       PHI        KC   \n",
       "\n",
       "      season_type week posteam posteam_type defteam side_of_field  \\\n",
       "50146        POST   22     NaN          NaN     NaN           NaN   \n",
       "\n",
       "      yardline_100   game_date quarter_seconds_remaining  \\\n",
       "50146          NaN  2023-02-12                       0.0   \n",
       "\n",
       "      half_seconds_remaining game_seconds_remaining game_half quarter_end  \\\n",
       "50146                    0.0                    0.0     Half2         0.0   \n",
       "\n",
       "      drive   sp  qtr down goal_to_go   time yrdln ydstogo ydsnet      desc  \\\n",
       "50146  18.0  0.0  4.0  NaN        0.0  00:00   NaN     0.0    0.0  END GAME   \n",
       "\n",
       "      play_type yards_gained shotgun no_huddle qb_dropback qb_kneel qb_spike  \\\n",
       "50146       NaN          NaN     0.0       0.0         NaN      0.0      0.0   \n",
       "\n",
       "      qb_scramble pass_length pass_location air_yards yards_after_catch  \\\n",
       "50146         0.0         NaN           NaN       NaN               NaN   \n",
       "\n",
       "      run_location run_gap field_goal_result kick_distance extra_point_result  \\\n",
       "50146          NaN     NaN               NaN           NaN                NaN   \n",
       "\n",
       "      two_point_conv_result home_timeouts_remaining away_timeouts_remaining  \\\n",
       "50146                   NaN                     0.0                     0.0   \n",
       "\n",
       "      timeout timeout_team td_team td_player_name td_player_id  \\\n",
       "50146     NaN          NaN     NaN            NaN          NaN   \n",
       "\n",
       "      posteam_timeouts_remaining defteam_timeouts_remaining total_home_score  \\\n",
       "50146                        NaN                        NaN             35.0   \n",
       "\n",
       "      total_away_score posteam_score defteam_score score_differential  \\\n",
       "50146             38.0           NaN           NaN                NaN   \n",
       "\n",
       "      posteam_score_post defteam_score_post score_differential_post   ep   wp  \\\n",
       "50146                NaN                NaN                     NaN  NaN  NaN   \n",
       "\n",
       "      def_wp home_wp away_wp home_wp_post away_wp_post punt_blocked  \\\n",
       "50146    NaN     0.0     1.0          0.0          1.0          NaN   \n",
       "\n",
       "      first_down_rush first_down_pass first_down_penalty third_down_converted  \\\n",
       "50146             NaN             NaN                NaN                  NaN   \n",
       "\n",
       "      third_down_failed fourth_down_converted fourth_down_failed  \\\n",
       "50146               NaN                   NaN                NaN   \n",
       "\n",
       "      incomplete_pass touchback interception punt_inside_twenty  \\\n",
       "50146             NaN       0.0          NaN                NaN   \n",
       "\n",
       "      punt_in_endzone punt_out_of_bounds punt_downed punt_fair_catch  \\\n",
       "50146             NaN                NaN         NaN             NaN   \n",
       "\n",
       "      kickoff_inside_twenty kickoff_in_endzone kickoff_out_of_bounds  \\\n",
       "50146                   NaN                NaN                   NaN   \n",
       "\n",
       "      kickoff_downed kickoff_fair_catch fumble_forced fumble_not_forced  \\\n",
       "50146            NaN                NaN           NaN               NaN   \n",
       "\n",
       "      fumble_out_of_bounds solo_tackle safety penalty tackled_for_loss  \\\n",
       "50146                  NaN         NaN    NaN     NaN              NaN   \n",
       "\n",
       "      fumble_lost own_kickoff_recovery own_kickoff_recovery_td qb_hit  \\\n",
       "50146         NaN                  NaN                     NaN    NaN   \n",
       "\n",
       "      rush_attempt pass_attempt sack touchdown pass_touchdown rush_touchdown  \\\n",
       "50146          NaN          NaN  NaN       NaN            NaN            NaN   \n",
       "\n",
       "      return_touchdown extra_point_attempt two_point_attempt  \\\n",
       "50146              NaN                 NaN               NaN   \n",
       "\n",
       "      field_goal_attempt kickoff_attempt punt_attempt fumble complete_pass  \\\n",
       "50146                NaN             NaN          NaN    NaN           NaN   \n",
       "\n",
       "      assist_tackle lateral_reception lateral_rush lateral_return  \\\n",
       "50146           NaN               NaN          NaN            NaN   \n",
       "\n",
       "      lateral_recovery passer_player_id passer_player_name passing_yards  \\\n",
       "50146              NaN              NaN                NaN           NaN   \n",
       "\n",
       "      receiver_player_id receiver_player_name receiving_yards  \\\n",
       "50146                NaN                  NaN             NaN   \n",
       "\n",
       "      rusher_player_id rusher_player_name rushing_yards  \\\n",
       "50146              NaN                NaN           NaN   \n",
       "\n",
       "      lateral_receiver_player_id lateral_receiver_player_name  \\\n",
       "50146                        NaN                          NaN   \n",
       "\n",
       "      lateral_receiving_yards lateral_rusher_player_id  \\\n",
       "50146                     NaN                      NaN   \n",
       "\n",
       "      lateral_rusher_player_name lateral_rushing_yards lateral_sack_player_id  \\\n",
       "50146                        NaN                   NaN                    NaN   \n",
       "\n",
       "      lateral_sack_player_name interception_player_id  \\\n",
       "50146                      NaN                    NaN   \n",
       "\n",
       "      interception_player_name lateral_interception_player_id  \\\n",
       "50146                      NaN                            NaN   \n",
       "\n",
       "      lateral_interception_player_name punt_returner_player_id  \\\n",
       "50146                              NaN                     NaN   \n",
       "\n",
       "      punt_returner_player_name lateral_punt_returner_player_id  \\\n",
       "50146                       NaN                             NaN   \n",
       "\n",
       "      lateral_punt_returner_player_name kickoff_returner_player_name  \\\n",
       "50146                               NaN                          NaN   \n",
       "\n",
       "      kickoff_returner_player_id lateral_kickoff_returner_player_id  \\\n",
       "50146                        NaN                                NaN   \n",
       "\n",
       "      lateral_kickoff_returner_player_name punter_player_id  \\\n",
       "50146                                  NaN              NaN   \n",
       "\n",
       "      punter_player_name kicker_player_name kicker_player_id  \\\n",
       "50146                NaN                NaN              NaN   \n",
       "\n",
       "      own_kickoff_recovery_player_id own_kickoff_recovery_player_name  \\\n",
       "50146                            NaN                              NaN   \n",
       "\n",
       "      blocked_player_id blocked_player_name tackle_for_loss_1_player_id  \\\n",
       "50146               NaN                 NaN                         NaN   \n",
       "\n",
       "      tackle_for_loss_1_player_name tackle_for_loss_2_player_id  \\\n",
       "50146                           NaN                         NaN   \n",
       "\n",
       "      tackle_for_loss_2_player_name qb_hit_1_player_id qb_hit_1_player_name  \\\n",
       "50146                           NaN                NaN                  NaN   \n",
       "\n",
       "      qb_hit_2_player_id qb_hit_2_player_name forced_fumble_player_1_team  \\\n",
       "50146                NaN                  NaN                         NaN   \n",
       "\n",
       "      forced_fumble_player_1_player_id forced_fumble_player_1_player_name  \\\n",
       "50146                              NaN                                NaN   \n",
       "\n",
       "      forced_fumble_player_2_team forced_fumble_player_2_player_id  \\\n",
       "50146                         NaN                              NaN   \n",
       "\n",
       "      forced_fumble_player_2_player_name solo_tackle_1_team  \\\n",
       "50146                                NaN                NaN   \n",
       "\n",
       "      solo_tackle_2_team solo_tackle_1_player_id solo_tackle_2_player_id  \\\n",
       "50146                NaN                     NaN                     NaN   \n",
       "\n",
       "      solo_tackle_1_player_name solo_tackle_2_player_name  \\\n",
       "50146                       NaN                       NaN   \n",
       "\n",
       "      assist_tackle_1_player_id assist_tackle_1_player_name  \\\n",
       "50146                       NaN                         NaN   \n",
       "\n",
       "      assist_tackle_1_team assist_tackle_2_player_id  \\\n",
       "50146                  NaN                       NaN   \n",
       "\n",
       "      assist_tackle_2_player_name assist_tackle_2_team  \\\n",
       "50146                         NaN                  NaN   \n",
       "\n",
       "      assist_tackle_3_player_id assist_tackle_3_player_name  \\\n",
       "50146                       NaN                         NaN   \n",
       "\n",
       "      assist_tackle_3_team assist_tackle_4_player_id  \\\n",
       "50146                  NaN                       NaN   \n",
       "\n",
       "      assist_tackle_4_player_name assist_tackle_4_team tackle_with_assist  \\\n",
       "50146                         NaN                  NaN                NaN   \n",
       "\n",
       "      tackle_with_assist_1_player_id tackle_with_assist_1_player_name  \\\n",
       "50146                            NaN                              NaN   \n",
       "\n",
       "      tackle_with_assist_1_team tackle_with_assist_2_player_id  \\\n",
       "50146                       NaN                            NaN   \n",
       "\n",
       "      tackle_with_assist_2_player_name tackle_with_assist_2_team  \\\n",
       "50146                              NaN                       NaN   \n",
       "\n",
       "      pass_defense_1_player_id pass_defense_1_player_name  \\\n",
       "50146                      NaN                        NaN   \n",
       "\n",
       "      pass_defense_2_player_id pass_defense_2_player_name fumbled_1_team  \\\n",
       "50146                      NaN                        NaN            NaN   \n",
       "\n",
       "      fumbled_1_player_id fumbled_1_player_name fumbled_2_player_id  \\\n",
       "50146                 NaN                   NaN                 NaN   \n",
       "\n",
       "      fumbled_2_player_name fumbled_2_team fumble_recovery_1_team  \\\n",
       "50146                   NaN            NaN                    NaN   \n",
       "\n",
       "      fumble_recovery_1_yards fumble_recovery_1_player_id  \\\n",
       "50146                     NaN                         NaN   \n",
       "\n",
       "      fumble_recovery_1_player_name fumble_recovery_2_team  \\\n",
       "50146                           NaN                    NaN   \n",
       "\n",
       "      fumble_recovery_2_yards fumble_recovery_2_player_id  \\\n",
       "50146                     NaN                         NaN   \n",
       "\n",
       "      fumble_recovery_2_player_name sack_player_id sack_player_name  \\\n",
       "50146                           NaN            NaN              NaN   \n",
       "\n",
       "      half_sack_1_player_id half_sack_1_player_name half_sack_2_player_id  \\\n",
       "50146                   NaN                     NaN                   NaN   \n",
       "\n",
       "      half_sack_2_player_name return_team return_yards penalty_team  \\\n",
       "50146                     NaN         NaN          NaN          NaN   \n",
       "\n",
       "      penalty_player_id penalty_player_name penalty_yards replay_or_challenge  \\\n",
       "50146               NaN                 NaN           NaN                 0.0   \n",
       "\n",
       "      replay_or_challenge_result penalty_type defensive_two_point_attempt  \\\n",
       "50146                        NaN          NaN                         NaN   \n",
       "\n",
       "      defensive_two_point_conv defensive_extra_point_attempt  \\\n",
       "50146                      NaN                           NaN   \n",
       "\n",
       "      defensive_extra_point_conv safety_player_name safety_player_id season  \\\n",
       "50146                        NaN                NaN              NaN   2022   \n",
       "\n",
       "        cp cpoe series series_success series_result order_sequence start_time  \\\n",
       "50146  NaN  NaN   56.0            0.0   End of half         4094.0   18:30:00   \n",
       "\n",
       "      time_of_day stadium weather                            nfl_api_id  \\\n",
       "50146         NaN     NaN     NaN  10160000-0591-71e8-06f2-f6c338c350ce   \n",
       "\n",
       "      play_clock play_deleted play_type_nfl special_teams_play st_play_type  \\\n",
       "50146          0          0.0      END_GAME                0.0          NaN   \n",
       "\n",
       "      end_clock_time end_yard_line fixed_drive fixed_drive_result  \\\n",
       "50146            NaN           NaN        18.0        End of half   \n",
       "\n",
       "      drive_real_start_time drive_play_count drive_time_of_possession  \\\n",
       "50146                   NaN              1.0                     0:08   \n",
       "\n",
       "      drive_first_downs drive_inside20 drive_ended_with_score  \\\n",
       "50146               0.0            0.0                    0.0   \n",
       "\n",
       "      drive_quarter_start drive_quarter_end drive_yards_penalized  \\\n",
       "50146                 4.0               4.0                   0.0   \n",
       "\n",
       "      drive_start_transition drive_end_transition drive_game_clock_start  \\\n",
       "50146                KICKOFF             END_GAME                  00:08   \n",
       "\n",
       "      drive_game_clock_end drive_start_yard_line drive_end_yard_line  \\\n",
       "50146                00:00                PHI 36              PHI 36   \n",
       "\n",
       "      drive_play_id_started drive_play_id_ended away_score home_score  \\\n",
       "50146                4050.0              4094.0         38         35   \n",
       "\n",
       "      location result total spread_line total_line div_game    roof surface  \\\n",
       "50146  Neutral     -3    73         1.0       51.0        0  closed   grass   \n",
       "\n",
       "      temp wind     home_coach away_coach stadium_id        game_stadium  \\\n",
       "50146  NaN  NaN  Nick Sirianni  Andy Reid      PHO00  State Farm Stadium   \n",
       "\n",
       "      aborted_play success passer passer_jersey_number rusher  \\\n",
       "50146          0.0     NaN    NaN                  NaN    NaN   \n",
       "\n",
       "      rusher_jersey_number receiver receiver_jersey_number pass rush  \\\n",
       "50146                  NaN      NaN                    NaN  0.0  0.0   \n",
       "\n",
       "      first_down special play passer_id rusher_id receiver_id name  \\\n",
       "50146        NaN     0.0  0.0       NaN       NaN         NaN  NaN   \n",
       "\n",
       "      jersey_number   id fantasy_player_name fantasy_player_id fantasy  \\\n",
       "50146           NaN  NaN                 NaN               NaN     NaN   \n",
       "\n",
       "      fantasy_id out_of_bounds home_opening_kickoff xyac_mean_yardage  \\\n",
       "50146        NaN           0.0                  1.0               NaN   \n",
       "\n",
       "      xyac_median_yardage xyac_success xyac_fd xpass pass_oe nflverse_game_id  \\\n",
       "50146                 NaN          NaN     NaN   NaN     NaN   2022_23_KC_PHI   \n",
       "\n",
       "      possession_team offense_formation offense_personnel defenders_in_box  \\\n",
       "50146             NaN               NaN               NaN              NaN   \n",
       "\n",
       "      defense_personnel number_of_pass_rushers players_on_play  \\\n",
       "50146               NaN                    NaN             NaN   \n",
       "\n",
       "      offense_players defense_players n_offense n_defense  \n",
       "50146             NaN             NaN         0         0  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "for c in pbp.columns:\n",
    "    print(c, end = '   ;   ')\n",
    "for row in pbp.tail(1).iloc:\n",
    "    # 300 column and dozens of NaN's ; remove all when trying to learn df\n",
    "    # display neatly \n",
    "    row = pd.DataFrame(row).transpose()\n",
    "    display(row)\n",
    "#     print(row.passer_id.values[0], row.rusher_id.values[0], row.receiver_id.values[0])\n",
    "    \n",
    "#     try:\n",
    "#         if np.isnan(row.passer_player_name.values[0]):\n",
    "#             display(row)\n",
    "# #             print(row.desc.values[0] , row.receiver_player_name.values[0])\n",
    "# #             print(red('yay'))\n",
    "#     except : \n",
    "#         pass\n",
    "# #     print( red(row.posteam.values[0]) ,row.desc.values[0] )"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "47b0e557",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.12"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
